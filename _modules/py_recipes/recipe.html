

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>py_recipes.recipe &mdash; py-tidymodels 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            py-tidymodels
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/installation.html#installation-steps">Installation Steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#clone-the-repository">1. Clone the Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#create-virtual-environment">2. Create Virtual Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#install-package">3. Install Package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/installation.html#development-installation-editable">Development Installation (Editable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/installation.html#standard-installation">Standard Installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#install-optional-dependencies">4. Install Optional Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#verify-installation">5. Verify Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/installation.html#jupyter-notebook-setup">Jupyter Notebook Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/installation.html#development-installation">Development Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/installation.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#prophet-installation-issues">Prophet Installation Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#windows-issues">Windows Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#import-errors">Import Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/installation.html#kernel-not-found-in-jupyter">Kernel Not Found in Jupyter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/quickstart.html">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quickstart.html#basic-regression">Basic Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quickstart.html#time-series-forecasting">Time Series Forecasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quickstart.html#feature-engineering-with-recipes">Feature Engineering with Recipes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quickstart.html#hyperparameter-tuning">Hyperparameter Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quickstart.html#multi-model-comparison">Multi-Model Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quickstart.html#model-stacking">Model Stacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/concepts.html">Core Concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/concepts.html#architecture-overview">Architecture Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#layer-1-py-hardhat">Layer 1: py-hardhat</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#layer-2-py-parsnip">Layer 2: py-parsnip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#layer-3-py-rsample">Layer 3: py-rsample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#layer-4-8-higher-level-tools">Layer 4-8: Higher-Level Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/concepts.html#key-design-principles">Key Design Principles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#immutability">Immutability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#composability">Composability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#method-chaining">Method Chaining</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#standardized-outputs">Standardized Outputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/concepts.html#data-flow">Data Flow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#training-flow">Training Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#prediction-flow">Prediction Flow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/concepts.html#working-with-formulas">Working with Formulas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#basic-formulas">Basic Formulas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#categorical-variables">Categorical Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/concepts.html#working-with-recipes">Working with Recipes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#recipe-workflow">Recipe Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#why-prep-bake">Why prep/bake?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/concepts.html#time-series-considerations">Time Series Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#date-column-handling">Date Column Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#raw-vs-standard-path">Raw vs Standard Path</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/concepts.html#panel-grouped-modeling">Panel/Grouped Modeling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#nested-approach">Nested Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#global-approach">Global Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/concepts.html#when-to-use-each">When to Use Each</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/concepts.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/recipes.html">Recipe Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/recipes.html#what-are-recipes">What Are Recipes?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/recipes.html#the-prep-bake-pattern">The prep/bake Pattern</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#basic-workflow">Basic Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#why-separate-prep-and-bake">Why Separate prep and bake?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/recipes.html#recipe-steps-by-category">Recipe Steps by Category</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#imputation-steps">Imputation Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#normalization-steps">Normalization Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#encoding-steps">Encoding Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#feature-engineering-steps">Feature Engineering Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#filtering-steps">Filtering Steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#time-series-steps">Time Series Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/recipes.html#complete-example">Complete Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#real-world-pipeline">Real-World Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#time-series-example">Time Series Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/recipes.html#selectors">Selectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#built-in-selectors">Built-in Selectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#custom-selection">Custom Selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/recipes.html#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#order-of-operations">Order of Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#avoid-data-leakage">Avoid Data Leakage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#reuse-prepped-recipes">Reuse Prepped Recipes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/recipes.html#common-patterns">Common Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#handling-missing-data">Handling Missing Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#dealing-with-skewness">Dealing with Skewness</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#reducing-dimensionality">Reducing Dimensionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/recipes.html#rare-categories">Rare Categories</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/recipes.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/time_series.html">Time Series Modeling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/time_series.html#time-series-models">Time Series Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#native-time-series-models">Native Time Series Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#hybrid-models">Hybrid Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/time_series.html#data-preparation">Data Preparation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#date-column-handling">Date Column Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#time-series-splits">Time Series Splits</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/time_series.html#feature-engineering-for-time-series">Feature Engineering for Time Series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#lagged-features">Lagged Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#rolling-statistics">Rolling Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#time-features">Time Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#differencing">Differencing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/time_series.html#complete-examples">Complete Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#prophet-forecasting">Prophet Forecasting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#arima-with-auto-selection">ARIMA with Auto Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#recursive-ml-forecasting">Recursive ML Forecasting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#using-ml-models-for-time-series-regression">Using ML Models for Time Series Regression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/time_series.html#random-forest-example">Random Forest Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/time_series.html#gradient-boosting-example-xgboost-lightgbm-catboost">Gradient Boosting Example (XGBoost/LightGBM/CatBoost)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/time_series.html#support-vector-machines-example">Support Vector Machines Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/time_series.html#k-nearest-neighbors-example">k-Nearest Neighbors Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/time_series.html#neural-network-mlp-example">Neural Network (MLP) Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/time_series.html#feature-engineering-for-ml-time-series-models">Feature Engineering for ML Time Series Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/time_series.html#understanding-the-three-dataframe-output">Understanding the Three-DataFrame Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/time_series.html#comparing-multiple-ml-models">Comparing Multiple ML Models</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#panel-grouped-time-series">Panel/Grouped Time Series</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/time_series.html#hyperparameter-tuning-for-time-series">Hyperparameter Tuning for Time Series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#cross-validation">Cross-Validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/time_series.html#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#check-stationarity">Check Stationarity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#handle-seasonality">Handle Seasonality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#validate-on-holdout">Validate on Holdout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#check-residuals">Check Residuals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#use-appropriate-metrics">Use Appropriate Metrics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/time_series.html#common-issues">Common Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#missing-dates">Missing Dates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#irregular-frequency">Irregular Frequency</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/time_series.html#multiple-seasonality">Multiple Seasonality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/time_series.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/tuning.html">Hyperparameter Tuning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/tuning.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/tuning.html#grid-types">Grid Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/tuning.html#regular-grid">Regular Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/tuning.html#random-grid">Random Grid</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/tuning.html#analyzing-results">Analyzing Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/tuning.html#time-series-tuning">Time Series Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/tuning.html#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/tuning.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/workflows.html">Workflow Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/workflows.html#basic-workflow">Basic Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/workflows.html#method-chaining">Method Chaining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/workflows.html#with-recipes">With Recipes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/workflows.html#panel-grouped-models">Panel/Grouped Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/workflows.html#nested-approach">Nested Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/workflows.html#global-approach">Global Approach</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/workflows.html#extracting-components">Extracting Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/workflows.html#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/workflows.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/visualization.html">Visualization Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#basic-usage-pattern">Basic Usage Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#forecast-visualization">Forecast Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/visualization.html#plot-forecast">plot_forecast()</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/visualization.html#plot-forecast-multi">plot_forecast_multi()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#residual-diagnostics">Residual Diagnostics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/visualization.html#plot-residuals">plot_residuals()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#model-comparison">Model Comparison</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/visualization.html#plot-model-comparison">plot_model_comparison()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#hyperparameter-tuning-visualization">Hyperparameter Tuning Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/visualization.html#plot-tune-results">plot_tune_results()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#saving-and-exporting-plots">Saving and Exporting Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#advanced-customization">Advanced Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#api-reference">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/visualization.html#examples">Examples</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html">Complete API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#linear-generalized-models">Linear &amp; Generalized Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#linear-reg">linear_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#poisson-reg">poisson_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#gen-additive-mod">gen_additive_mod()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#tree-based-models">Tree-Based Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#decision-tree">decision_tree()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#rand-forest">rand_forest()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#boost-tree">boost_tree()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#support-vector-machines">Support Vector Machines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#svm-rbf">svm_rbf()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#svm-linear">svm_linear()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#instance-based-models">Instance-Based Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#nearest-neighbor">nearest_neighbor()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#mars">mars()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#mlp">mlp()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#time-series-models">Time Series Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#arima-reg">arima_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#prophet-reg">prophet_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#exp-smoothing">exp_smoothing()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#seasonal-reg">seasonal_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#recursive-reg">recursive_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#varmax-reg">varmax_reg()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#hybrid-time-series-models">Hybrid Time Series Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#arima-boost">arima_boost()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#prophet-boost">prophet_boost()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#generic-hybrid-models">Generic Hybrid Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#hybrid-model">hybrid_model()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#baseline-models">Baseline Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#null-model">null_model()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#naive-reg">naive_reg()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#manual-coefficient-models">Manual Coefficient Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#manual-reg">manual_reg()</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#cross-cutting-concepts">Cross-Cutting Concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#engine-selection">Engine Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#mode-setting">Mode Setting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#tunable-parameters">Tunable Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#prediction-types">Prediction Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#output-structure">Output Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#formula-syntax">Formula Syntax</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#performance-considerations">Performance Considerations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#model-selection-guide">Model Selection Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#computational-complexity">Computational Complexity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#memory-usage">Memory Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#parallelization">Parallelization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../complete_api_reference.html#common-workflows">Common Workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#basic-regression">Basic Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#time-series-forecasting">Time Series Forecasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#hyperparameter-tuning">Hyperparameter Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../complete_api_reference.html#multi-model-comparison">Multi-Model Comparison</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/hardhat.html">py-hardhat: Data Preprocessing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/hardhat.html#core-classes">Core Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint"><code class="docutils literal notranslate"><span class="pre">Blueprint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.formula"><code class="docutils literal notranslate"><span class="pre">Blueprint.formula</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.roles"><code class="docutils literal notranslate"><span class="pre">Blueprint.roles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.factor_levels"><code class="docutils literal notranslate"><span class="pre">Blueprint.factor_levels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.column_order"><code class="docutils literal notranslate"><span class="pre">Blueprint.column_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.ptypes"><code class="docutils literal notranslate"><span class="pre">Blueprint.ptypes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.intercept"><code class="docutils literal notranslate"><span class="pre">Blueprint.intercept</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.indicators"><code class="docutils literal notranslate"><span class="pre">Blueprint.indicators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.design_info"><code class="docutils literal notranslate"><span class="pre">Blueprint.design_info</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.outcome_design_info"><code class="docutils literal notranslate"><span class="pre">Blueprint.outcome_design_info</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id0"><code class="docutils literal notranslate"><span class="pre">Blueprint.formula</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id1"><code class="docutils literal notranslate"><span class="pre">Blueprint.roles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id2"><code class="docutils literal notranslate"><span class="pre">Blueprint.factor_levels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id3"><code class="docutils literal notranslate"><span class="pre">Blueprint.column_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id4"><code class="docutils literal notranslate"><span class="pre">Blueprint.ptypes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id5"><code class="docutils literal notranslate"><span class="pre">Blueprint.intercept</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id6"><code class="docutils literal notranslate"><span class="pre">Blueprint.indicators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id7"><code class="docutils literal notranslate"><span class="pre">Blueprint.design_info</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id8"><code class="docutils literal notranslate"><span class="pre">Blueprint.outcome_design_info</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.__post_init__"><code class="docutils literal notranslate"><span class="pre">Blueprint.__post_init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.Blueprint.__init__"><code class="docutils literal notranslate"><span class="pre">Blueprint.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.MoldedData"><code class="docutils literal notranslate"><span class="pre">MoldedData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.MoldedData.outcomes"><code class="docutils literal notranslate"><span class="pre">MoldedData.outcomes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.MoldedData.predictors"><code class="docutils literal notranslate"><span class="pre">MoldedData.predictors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.MoldedData.blueprint"><code class="docutils literal notranslate"><span class="pre">MoldedData.blueprint</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.MoldedData.extras"><code class="docutils literal notranslate"><span class="pre">MoldedData.extras</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id9"><code class="docutils literal notranslate"><span class="pre">MoldedData.outcomes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id10"><code class="docutils literal notranslate"><span class="pre">MoldedData.predictors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id11"><code class="docutils literal notranslate"><span class="pre">MoldedData.blueprint</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#id12"><code class="docutils literal notranslate"><span class="pre">MoldedData.extras</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.MoldedData.__post_init__"><code class="docutils literal notranslate"><span class="pre">MoldedData.__post_init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.MoldedData.__init__"><code class="docutils literal notranslate"><span class="pre">MoldedData.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/hardhat.html#main-functions">Main Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.mold"><code class="docutils literal notranslate"><span class="pre">mold()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/hardhat.html#py_hardhat.forge"><code class="docutils literal notranslate"><span class="pre">forge()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/hardhat.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/hardhat.html#basic-mold-forge">Basic Mold/Forge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/hardhat.html#formula-transformations">Formula Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/hardhat.html#categorical-handling">Categorical Handling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/parsnip.html">py-parsnip: Model Specification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#core-classes">Core Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec"><code class="docutils literal notranslate"><span class="pre">ModelSpec</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.model_type"><code class="docutils literal notranslate"><span class="pre">ModelSpec.model_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.engine"><code class="docutils literal notranslate"><span class="pre">ModelSpec.engine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.mode"><code class="docutils literal notranslate"><span class="pre">ModelSpec.mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.args"><code class="docutils literal notranslate"><span class="pre">ModelSpec.args</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.date_col"><code class="docutils literal notranslate"><span class="pre">ModelSpec.date_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id0"><code class="docutils literal notranslate"><span class="pre">ModelSpec.model_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id1"><code class="docutils literal notranslate"><span class="pre">ModelSpec.engine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id2"><code class="docutils literal notranslate"><span class="pre">ModelSpec.mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id3"><code class="docutils literal notranslate"><span class="pre">ModelSpec.args</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id4"><code class="docutils literal notranslate"><span class="pre">ModelSpec.date_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.set_engine"><code class="docutils literal notranslate"><span class="pre">ModelSpec.set_engine()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.set_mode"><code class="docutils literal notranslate"><span class="pre">ModelSpec.set_mode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.set_args"><code class="docutils literal notranslate"><span class="pre">ModelSpec.set_args()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.fit"><code class="docutils literal notranslate"><span class="pre">ModelSpec.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.fit_nested"><code class="docutils literal notranslate"><span class="pre">ModelSpec.fit_nested()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.fit_global"><code class="docutils literal notranslate"><span class="pre">ModelSpec.fit_global()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelSpec.__init__"><code class="docutils literal notranslate"><span class="pre">ModelSpec.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit"><code class="docutils literal notranslate"><span class="pre">ModelFit</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.spec"><code class="docutils literal notranslate"><span class="pre">ModelFit.spec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.fit_data"><code class="docutils literal notranslate"><span class="pre">ModelFit.fit_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.blueprint"><code class="docutils literal notranslate"><span class="pre">ModelFit.blueprint</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.fit_time"><code class="docutils literal notranslate"><span class="pre">ModelFit.fit_time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.evaluation_data"><code class="docutils literal notranslate"><span class="pre">ModelFit.evaluation_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.model_name"><code class="docutils literal notranslate"><span class="pre">ModelFit.model_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.model_group_name"><code class="docutils literal notranslate"><span class="pre">ModelFit.model_group_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id5"><code class="docutils literal notranslate"><span class="pre">ModelFit.spec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id6"><code class="docutils literal notranslate"><span class="pre">ModelFit.fit_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id7"><code class="docutils literal notranslate"><span class="pre">ModelFit.blueprint</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id8"><code class="docutils literal notranslate"><span class="pre">ModelFit.fit_time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id9"><code class="docutils literal notranslate"><span class="pre">ModelFit.evaluation_data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id10"><code class="docutils literal notranslate"><span class="pre">ModelFit.model_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#id11"><code class="docutils literal notranslate"><span class="pre">ModelFit.model_group_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.predict"><code class="docutils literal notranslate"><span class="pre">ModelFit.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.extract_fit_engine"><code class="docutils literal notranslate"><span class="pre">ModelFit.extract_fit_engine()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.evaluate"><code class="docutils literal notranslate"><span class="pre">ModelFit.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.extract_outputs"><code class="docutils literal notranslate"><span class="pre">ModelFit.extract_outputs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.ModelFit.__init__"><code class="docutils literal notranslate"><span class="pre">ModelFit.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#linear-models">Linear Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.linear_reg"><code class="docutils literal notranslate"><span class="pre">linear_reg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.poisson_reg"><code class="docutils literal notranslate"><span class="pre">poisson_reg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.gen_additive_mod"><code class="docutils literal notranslate"><span class="pre">gen_additive_mod()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#tree-based-models">Tree-Based Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.decision_tree"><code class="docutils literal notranslate"><span class="pre">decision_tree()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.rand_forest"><code class="docutils literal notranslate"><span class="pre">rand_forest()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.boost_tree"><code class="docutils literal notranslate"><span class="pre">boost_tree()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#support-vector-machines">Support Vector Machines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.svm_rbf"><code class="docutils literal notranslate"><span class="pre">svm_rbf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.svm_linear"><code class="docutils literal notranslate"><span class="pre">svm_linear()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#instance-based-models">Instance-Based Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.nearest_neighbor"><code class="docutils literal notranslate"><span class="pre">nearest_neighbor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.mars"><code class="docutils literal notranslate"><span class="pre">mars()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.mlp"><code class="docutils literal notranslate"><span class="pre">mlp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#time-series-models">Time Series Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.arima_reg"><code class="docutils literal notranslate"><span class="pre">arima_reg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.prophet_reg"><code class="docutils literal notranslate"><span class="pre">prophet_reg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.exp_smoothing"><code class="docutils literal notranslate"><span class="pre">exp_smoothing()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.seasonal_reg"><code class="docutils literal notranslate"><span class="pre">seasonal_reg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.recursive_reg"><code class="docutils literal notranslate"><span class="pre">recursive_reg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#hybrid-time-series-models">Hybrid Time Series Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.arima_boost"><code class="docutils literal notranslate"><span class="pre">arima_boost()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.prophet_boost"><code class="docutils literal notranslate"><span class="pre">prophet_boost()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#baseline-models">Baseline Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.null_model"><code class="docutils literal notranslate"><span class="pre">null_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.naive_reg"><code class="docutils literal notranslate"><span class="pre">naive_reg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#generic-hybrid-models">Generic Hybrid Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.hybrid_model"><code class="docutils literal notranslate"><span class="pre">hybrid_model()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#manual-coefficient-models">Manual Coefficient Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.manual_reg"><code class="docutils literal notranslate"><span class="pre">manual_reg()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#module-py_parsnip.engine_registry">Engine Registry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.engine_registry.Engine"><code class="docutils literal notranslate"><span class="pre">Engine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.engine_registry.Engine.param_map"><code class="docutils literal notranslate"><span class="pre">Engine.param_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.engine_registry.Engine.fit"><code class="docutils literal notranslate"><span class="pre">Engine.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.engine_registry.Engine.predict"><code class="docutils literal notranslate"><span class="pre">Engine.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.engine_registry.Engine.extract_outputs"><code class="docutils literal notranslate"><span class="pre">Engine.extract_outputs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.engine_registry.Engine.translate_params"><code class="docutils literal notranslate"><span class="pre">Engine.translate_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.engine_registry.register_engine"><code class="docutils literal notranslate"><span class="pre">register_engine()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.engine_registry.get_engine"><code class="docutils literal notranslate"><span class="pre">get_engine()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#py_parsnip.engine_registry.list_engines"><code class="docutils literal notranslate"><span class="pre">list_engines()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/parsnip.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#time-series-model">Time Series Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/parsnip.html#gradient-boosting">Gradient Boosting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/rsample.html">py-rsample: Resampling &amp; Cross-Validation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/rsample.html#core-classes">Core Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/rsample.html#py_rsample.Split"><code class="docutils literal notranslate"><span class="pre">Split</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.Split.data"><code class="docutils literal notranslate"><span class="pre">Split.data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.Split.in_id"><code class="docutils literal notranslate"><span class="pre">Split.in_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.Split.out_id"><code class="docutils literal notranslate"><span class="pre">Split.out_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.Split.id"><code class="docutils literal notranslate"><span class="pre">Split.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#id0"><code class="docutils literal notranslate"><span class="pre">Split.data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#id1"><code class="docutils literal notranslate"><span class="pre">Split.in_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#id2"><code class="docutils literal notranslate"><span class="pre">Split.out_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#id3"><code class="docutils literal notranslate"><span class="pre">Split.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.Split.__init__"><code class="docutils literal notranslate"><span class="pre">Split.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/rsample.html#py_rsample.RSplit"><code class="docutils literal notranslate"><span class="pre">RSplit</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.RSplit.split"><code class="docutils literal notranslate"><span class="pre">RSplit.split</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.RSplit.training"><code class="docutils literal notranslate"><span class="pre">RSplit.training()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.RSplit.testing"><code class="docutils literal notranslate"><span class="pre">RSplit.testing()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.RSplit.analysis"><code class="docutils literal notranslate"><span class="pre">RSplit.analysis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.RSplit.assessment"><code class="docutils literal notranslate"><span class="pre">RSplit.assessment()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.RSplit.__init__"><code class="docutils literal notranslate"><span class="pre">RSplit.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#id4"><code class="docutils literal notranslate"><span class="pre">RSplit.split</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#id5"><code class="docutils literal notranslate"><span class="pre">RSplit.training()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#id6"><code class="docutils literal notranslate"><span class="pre">RSplit.testing()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#id7"><code class="docutils literal notranslate"><span class="pre">RSplit.analysis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#id8"><code class="docutils literal notranslate"><span class="pre">RSplit.assessment()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.RSplit.__repr__"><code class="docutils literal notranslate"><span class="pre">RSplit.__repr__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.RSplit.__len__"><code class="docutils literal notranslate"><span class="pre">RSplit.__len__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/rsample.html#main-functions">Main Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/rsample.html#train-test-split">Train/Test Split</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.initial_split"><code class="docutils literal notranslate"><span class="pre">initial_split()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.initial_time_split"><code class="docutils literal notranslate"><span class="pre">initial_time_split()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.training"><code class="docutils literal notranslate"><span class="pre">training()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.testing"><code class="docutils literal notranslate"><span class="pre">testing()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/rsample.html#cross-validation">Cross-Validation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.vfold_cv"><code class="docutils literal notranslate"><span class="pre">vfold_cv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/rsample.html#py_rsample.time_series_cv"><code class="docutils literal notranslate"><span class="pre">time_series_cv()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/rsample.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/rsample.html#basic-split">Basic Split</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/rsample.html#time-series-split">Time Series Split</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/rsample.html#k-fold-cross-validation">K-Fold Cross-Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/rsample.html#time-series-cross-validation">Time Series Cross-Validation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/workflows.html">py-workflows: Pipeline Composition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/workflows.html#core-classes">Core Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow"><code class="docutils literal notranslate"><span class="pre">Workflow</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.preprocessor"><code class="docutils literal notranslate"><span class="pre">Workflow.preprocessor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.spec"><code class="docutils literal notranslate"><span class="pre">Workflow.spec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.post"><code class="docutils literal notranslate"><span class="pre">Workflow.post</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.case_weights"><code class="docutils literal notranslate"><span class="pre">Workflow.case_weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.model_name"><code class="docutils literal notranslate"><span class="pre">Workflow.model_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.model_group_name"><code class="docutils literal notranslate"><span class="pre">Workflow.model_group_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id0"><code class="docutils literal notranslate"><span class="pre">Workflow.preprocessor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id1"><code class="docutils literal notranslate"><span class="pre">Workflow.spec</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id2"><code class="docutils literal notranslate"><span class="pre">Workflow.post</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id3"><code class="docutils literal notranslate"><span class="pre">Workflow.case_weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id4"><code class="docutils literal notranslate"><span class="pre">Workflow.model_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id5"><code class="docutils literal notranslate"><span class="pre">Workflow.model_group_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.add_formula"><code class="docutils literal notranslate"><span class="pre">Workflow.add_formula()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.add_model"><code class="docutils literal notranslate"><span class="pre">Workflow.add_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.add_recipe"><code class="docutils literal notranslate"><span class="pre">Workflow.add_recipe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.add_model_name"><code class="docutils literal notranslate"><span class="pre">Workflow.add_model_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.add_model_group_name"><code class="docutils literal notranslate"><span class="pre">Workflow.add_model_group_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.remove_formula"><code class="docutils literal notranslate"><span class="pre">Workflow.remove_formula()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.remove_model"><code class="docutils literal notranslate"><span class="pre">Workflow.remove_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.update_formula"><code class="docutils literal notranslate"><span class="pre">Workflow.update_formula()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.update_model"><code class="docutils literal notranslate"><span class="pre">Workflow.update_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.fit"><code class="docutils literal notranslate"><span class="pre">Workflow.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.fit_nested"><code class="docutils literal notranslate"><span class="pre">Workflow.fit_nested()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.fit_global"><code class="docutils literal notranslate"><span class="pre">Workflow.fit_global()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.Workflow.__init__"><code class="docutils literal notranslate"><span class="pre">Workflow.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit"><code class="docutils literal notranslate"><span class="pre">WorkflowFit</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.workflow"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.workflow</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.pre"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.pre</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.fit"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.fit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.post"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.post</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.formula"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.formula</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.recipe_prepped_without_outcome"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.recipe_prepped_without_outcome</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id6"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.workflow</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id7"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.pre</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id8"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.fit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id9"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.post</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id10"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.formula</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#id11"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.recipe_prepped_without_outcome</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.is_global_fit"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.is_global_fit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.group_col"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.group_col</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.predict"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.evaluate"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.extract_fit_parsnip"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.extract_fit_parsnip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.extract_preprocessor"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.extract_preprocessor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.extract_spec_parsnip"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.extract_spec_parsnip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.extract_outputs"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.extract_outputs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.extract_formula"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.extract_formula()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.extract_preprocessed_data"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.extract_preprocessed_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/workflows.html#py_workflows.WorkflowFit.__init__"><code class="docutils literal notranslate"><span class="pre">WorkflowFit.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/workflows.html#main-functions">Main Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflows.html#py_workflows.workflow"><code class="docutils literal notranslate"><span class="pre">workflow()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/workflows.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflows.html#basic-workflow">Basic Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflows.html#method-chaining">Method Chaining</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflows.html#panel-grouped-models">Panel/Grouped Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflows.html#extracting-components">Extracting Components</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/recipes.html">py-recipes: Feature Engineering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#core-classes">Core Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe"><code class="docutils literal notranslate"><span class="pre">Recipe</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.steps"><code class="docutils literal notranslate"><span class="pre">Recipe.steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.template"><code class="docutils literal notranslate"><span class="pre">Recipe.template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.roles"><code class="docutils literal notranslate"><span class="pre">Recipe.roles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#id0"><code class="docutils literal notranslate"><span class="pre">Recipe.steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#id1"><code class="docutils literal notranslate"><span class="pre">Recipe.template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#id2"><code class="docutils literal notranslate"><span class="pre">Recipe.roles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.add_step"><code class="docutils literal notranslate"><span class="pre">Recipe.add_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_rm"><code class="docutils literal notranslate"><span class="pre">Recipe.step_rm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_normalize"><code class="docutils literal notranslate"><span class="pre">Recipe.step_normalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_dummy"><code class="docutils literal notranslate"><span class="pre">Recipe.step_dummy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_impute_mean"><code class="docutils literal notranslate"><span class="pre">Recipe.step_impute_mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_impute_median"><code class="docutils literal notranslate"><span class="pre">Recipe.step_impute_median()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_mutate"><code class="docutils literal notranslate"><span class="pre">Recipe.step_mutate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_lag"><code class="docutils literal notranslate"><span class="pre">Recipe.step_lag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_diff"><code class="docutils literal notranslate"><span class="pre">Recipe.step_diff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_pct_change"><code class="docutils literal notranslate"><span class="pre">Recipe.step_pct_change()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_rolling"><code class="docutils literal notranslate"><span class="pre">Recipe.step_rolling()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_date"><code class="docutils literal notranslate"><span class="pre">Recipe.step_date()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_pca"><code class="docutils literal notranslate"><span class="pre">Recipe.step_pca()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_corr"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_corr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_log"><code class="docutils literal notranslate"><span class="pre">Recipe.step_log()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_sqrt"><code class="docutils literal notranslate"><span class="pre">Recipe.step_sqrt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_boxcox"><code class="docutils literal notranslate"><span class="pre">Recipe.step_boxcox()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_yeojohnson"><code class="docutils literal notranslate"><span class="pre">Recipe.step_yeojohnson()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_inverse"><code class="docutils literal notranslate"><span class="pre">Recipe.step_inverse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_center"><code class="docutils literal notranslate"><span class="pre">Recipe.step_center()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_scale"><code class="docutils literal notranslate"><span class="pre">Recipe.step_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_range"><code class="docutils literal notranslate"><span class="pre">Recipe.step_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_zv"><code class="docutils literal notranslate"><span class="pre">Recipe.step_zv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_nzv"><code class="docutils literal notranslate"><span class="pre">Recipe.step_nzv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_lincomb"><code class="docutils literal notranslate"><span class="pre">Recipe.step_lincomb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_filter_missing"><code class="docutils literal notranslate"><span class="pre">Recipe.step_filter_missing()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_filter_anova"><code class="docutils literal notranslate"><span class="pre">Recipe.step_filter_anova()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_filter_rf_importance"><code class="docutils literal notranslate"><span class="pre">Recipe.step_filter_rf_importance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_filter_mutual_info"><code class="docutils literal notranslate"><span class="pre">Recipe.step_filter_mutual_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_filter_roc_auc"><code class="docutils literal notranslate"><span class="pre">Recipe.step_filter_roc_auc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_filter_chisq"><code class="docutils literal notranslate"><span class="pre">Recipe.step_filter_chisq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_shap"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_shap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_permutation"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_permutation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_genetic_algorithm"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_genetic_algorithm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_splitwise"><code class="docutils literal notranslate"><span class="pre">Recipe.step_splitwise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_safe"><code class="docutils literal notranslate"><span class="pre">Recipe.step_safe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_safe_v2"><code class="docutils literal notranslate"><span class="pre">Recipe.step_safe_v2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_eix"><code class="docutils literal notranslate"><span class="pre">Recipe.step_eix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_naomit"><code class="docutils literal notranslate"><span class="pre">Recipe.step_naomit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_other"><code class="docutils literal notranslate"><span class="pre">Recipe.step_other()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_novel"><code class="docutils literal notranslate"><span class="pre">Recipe.step_novel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_unknown"><code class="docutils literal notranslate"><span class="pre">Recipe.step_unknown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_indicate_na"><code class="docutils literal notranslate"><span class="pre">Recipe.step_indicate_na()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_integer"><code class="docutils literal notranslate"><span class="pre">Recipe.step_integer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_impute_mode"><code class="docutils literal notranslate"><span class="pre">Recipe.step_impute_mode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_impute_knn"><code class="docutils literal notranslate"><span class="pre">Recipe.step_impute_knn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_impute_linear"><code class="docutils literal notranslate"><span class="pre">Recipe.step_impute_linear()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_bs"><code class="docutils literal notranslate"><span class="pre">Recipe.step_bs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_ns"><code class="docutils literal notranslate"><span class="pre">Recipe.step_ns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_poly"><code class="docutils literal notranslate"><span class="pre">Recipe.step_poly()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_harmonic"><code class="docutils literal notranslate"><span class="pre">Recipe.step_harmonic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_interact"><code class="docutils literal notranslate"><span class="pre">Recipe.step_interact()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_ratio"><code class="docutils literal notranslate"><span class="pre">Recipe.step_ratio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_discretize"><code class="docutils literal notranslate"><span class="pre">Recipe.step_discretize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_cut"><code class="docutils literal notranslate"><span class="pre">Recipe.step_cut()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_percentile"><code class="docutils literal notranslate"><span class="pre">Recipe.step_percentile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_ica"><code class="docutils literal notranslate"><span class="pre">Recipe.step_ica()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_kpca"><code class="docutils literal notranslate"><span class="pre">Recipe.step_kpca()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_pls"><code class="docutils literal notranslate"><span class="pre">Recipe.step_pls()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_holiday"><code class="docutils literal notranslate"><span class="pre">Recipe.step_holiday()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_fourier"><code class="docutils literal notranslate"><span class="pre">Recipe.step_fourier()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_timeseries_signature"><code class="docutils literal notranslate"><span class="pre">Recipe.step_timeseries_signature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_lead"><code class="docutils literal notranslate"><span class="pre">Recipe.step_lead()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_ewm"><code class="docutils literal notranslate"><span class="pre">Recipe.step_ewm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_expanding"><code class="docutils literal notranslate"><span class="pre">Recipe.step_expanding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.update_role"><code class="docutils literal notranslate"><span class="pre">Recipe.update_role()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.add_role"><code class="docutils literal notranslate"><span class="pre">Recipe.add_role()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.remove_role"><code class="docutils literal notranslate"><span class="pre">Recipe.remove_role()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.has_role"><code class="docutils literal notranslate"><span class="pre">Recipe.has_role()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_vip"><code class="docutils literal notranslate"><span class="pre">Recipe.step_vip()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_boruta"><code class="docutils literal notranslate"><span class="pre">Recipe.step_boruta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_rfe"><code class="docutils literal notranslate"><span class="pre">Recipe.step_rfe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_dt_discretiser"><code class="docutils literal notranslate"><span class="pre">Recipe.step_dt_discretiser()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_winsorizer"><code class="docutils literal notranslate"><span class="pre">Recipe.step_winsorizer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_outlier_trimmer"><code class="docutils literal notranslate"><span class="pre">Recipe.step_outlier_trimmer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_dt_features"><code class="docutils literal notranslate"><span class="pre">Recipe.step_dt_features()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_smart_corr"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_smart_corr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_psi"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_psi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_clean_anomalies"><code class="docutils literal notranslate"><span class="pre">Recipe.step_clean_anomalies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_stationary"><code class="docutils literal notranslate"><span class="pre">Recipe.step_stationary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_deseasonalize"><code class="docutils literal notranslate"><span class="pre">Recipe.step_deseasonalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_detrend"><code class="docutils literal notranslate"><span class="pre">Recipe.step_detrend()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_h_stat"><code class="docutils literal notranslate"><span class="pre">Recipe.step_h_stat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_best_lag"><code class="docutils literal notranslate"><span class="pre">Recipe.step_best_lag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_vif"><code class="docutils literal notranslate"><span class="pre">Recipe.step_vif()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_pvalue"><code class="docutils literal notranslate"><span class="pre">Recipe.step_pvalue()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_stability"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_stability()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_lofo"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_lofo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_granger"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_granger()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_stepwise"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_stepwise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_probe"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_probe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_lasso"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_lasso()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_ridge"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_ridge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_elastic_net"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_elastic_net()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_univariate"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_univariate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_variance_threshold"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_variance_threshold()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_stationary"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_stationary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_cointegration"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_cointegration()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_select_seasonal"><code class="docutils literal notranslate"><span class="pre">Recipe.step_select_seasonal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_fractional_diff"><code class="docutils literal notranslate"><span class="pre">Recipe.step_fractional_diff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_volatility_ewm"><code class="docutils literal notranslate"><span class="pre">Recipe.step_volatility_ewm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_permutation_entropy"><code class="docutils literal notranslate"><span class="pre">Recipe.step_permutation_entropy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.step_weight_time_decay"><code class="docutils literal notranslate"><span class="pre">Recipe.step_weight_time_decay()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.prep"><code class="docutils literal notranslate"><span class="pre">Recipe.prep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/recipes.html#py_recipes.Recipe.__init__"><code class="docutils literal notranslate"><span class="pre">Recipe.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#main-functions">Main Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.recipe"><code class="docutils literal notranslate"><span class="pre">recipe()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#module-py_recipes.selectors">Selectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.all_numeric"><code class="docutils literal notranslate"><span class="pre">all_numeric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.all_nominal"><code class="docutils literal notranslate"><span class="pre">all_nominal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.all_integer"><code class="docutils literal notranslate"><span class="pre">all_integer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.all_float"><code class="docutils literal notranslate"><span class="pre">all_float()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.all_string"><code class="docutils literal notranslate"><span class="pre">all_string()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.all_datetime"><code class="docutils literal notranslate"><span class="pre">all_datetime()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.starts_with"><code class="docutils literal notranslate"><span class="pre">starts_with()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.ends_with"><code class="docutils literal notranslate"><span class="pre">ends_with()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.contains"><code class="docutils literal notranslate"><span class="pre">contains()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.matches"><code class="docutils literal notranslate"><span class="pre">matches()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.everything"><code class="docutils literal notranslate"><span class="pre">everything()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.one_of"><code class="docutils literal notranslate"><span class="pre">one_of()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.none_of"><code class="docutils literal notranslate"><span class="pre">none_of()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.where"><code class="docutils literal notranslate"><span class="pre">where()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.union"><code class="docutils literal notranslate"><span class="pre">union()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.intersection"><code class="docutils literal notranslate"><span class="pre">intersection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.difference"><code class="docutils literal notranslate"><span class="pre">difference()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.all_predictors"><code class="docutils literal notranslate"><span class="pre">all_predictors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.all_outcomes"><code class="docutils literal notranslate"><span class="pre">all_outcomes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.all_numeric_predictors"><code class="docutils literal notranslate"><span class="pre">all_numeric_predictors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.all_nominal_predictors"><code class="docutils literal notranslate"><span class="pre">all_nominal_predictors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.has_role"><code class="docutils literal notranslate"><span class="pre">has_role()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#py_recipes.selectors.resolve_selector"><code class="docutils literal notranslate"><span class="pre">resolve_selector()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#imputation-steps-6">Imputation Steps (6)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#normalization-steps-4">Normalization Steps (4)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#encoding-steps-6">Encoding Steps (6)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#feature-engineering-steps-8">Feature Engineering Steps (8)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#filtering-steps-6">Filtering Steps (6)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#row-operations-6">Row Operations (6)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#transformation-steps-6">Transformation Steps (6)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#time-series-steps-4">Time Series Steps (4)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/recipes.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#basic-recipe">Basic Recipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#advanced-recipe">Advanced Recipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/recipes.html#time-series-recipe">Time Series Recipe</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/yardstick.html">py-yardstick: Model Metrics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/yardstick.html#main-functions">Main Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/yardstick.html#metric-set">Metric Set</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/yardstick.html#py_yardstick.metric_set"><code class="docutils literal notranslate"><span class="pre">metric_set()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/yardstick.html#regression-metrics-7">Regression Metrics (7)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/yardstick.html#py_yardstick.rmse"><code class="docutils literal notranslate"><span class="pre">rmse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/yardstick.html#py_yardstick.mae"><code class="docutils literal notranslate"><span class="pre">mae()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/yardstick.html#py_yardstick.mape"><code class="docutils literal notranslate"><span class="pre">mape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/yardstick.html#py_yardstick.smape"><code class="docutils literal notranslate"><span class="pre">smape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/yardstick.html#py_yardstick.r_squared"><code class="docutils literal notranslate"><span class="pre">r_squared()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/yardstick.html#classification-metrics-10">Classification Metrics (10)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/yardstick.html#py_yardstick.accuracy"><code class="docutils literal notranslate"><span class="pre">accuracy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/yardstick.html#py_yardstick.precision"><code class="docutils literal notranslate"><span class="pre">precision()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/yardstick.html#py_yardstick.recall"><code class="docutils literal notranslate"><span class="pre">recall()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/yardstick.html#py_yardstick.roc_auc"><code class="docutils literal notranslate"><span class="pre">roc_auc()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/yardstick.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/yardstick.html#individual-metrics">Individual Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/yardstick.html#id1">Metric Set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/yardstick.html#with-dataframes">With DataFrames</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/yardstick.html#classification-metrics">Classification Metrics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/tune.html">py-tune: Hyperparameter Tuning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/tune.html#core-classes">Core Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults"><code class="docutils literal notranslate"><span class="pre">TuneResults</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.metrics"><code class="docutils literal notranslate"><span class="pre">TuneResults.metrics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.predictions"><code class="docutils literal notranslate"><span class="pre">TuneResults.predictions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.workflow"><code class="docutils literal notranslate"><span class="pre">TuneResults.workflow</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.resamples"><code class="docutils literal notranslate"><span class="pre">TuneResults.resamples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.grid"><code class="docutils literal notranslate"><span class="pre">TuneResults.grid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.method"><code class="docutils literal notranslate"><span class="pre">TuneResults.method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#id0"><code class="docutils literal notranslate"><span class="pre">TuneResults.metrics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#id1"><code class="docutils literal notranslate"><span class="pre">TuneResults.predictions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#id2"><code class="docutils literal notranslate"><span class="pre">TuneResults.workflow</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#id3"><code class="docutils literal notranslate"><span class="pre">TuneResults.resamples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#id4"><code class="docutils literal notranslate"><span class="pre">TuneResults.grid</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#id5"><code class="docutils literal notranslate"><span class="pre">TuneResults.method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.collect_metrics"><code class="docutils literal notranslate"><span class="pre">TuneResults.collect_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.collect_predictions"><code class="docutils literal notranslate"><span class="pre">TuneResults.collect_predictions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.show_best"><code class="docutils literal notranslate"><span class="pre">TuneResults.show_best()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.select_best"><code class="docutils literal notranslate"><span class="pre">TuneResults.select_best()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.select_by_one_std_err"><code class="docutils literal notranslate"><span class="pre">TuneResults.select_by_one_std_err()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.TuneResults.__init__"><code class="docutils literal notranslate"><span class="pre">TuneResults.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/tune.html#main-functions">Main Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/tune.html#tuning">Tuning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.tune"><code class="docutils literal notranslate"><span class="pre">tune()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.tune_grid"><code class="docutils literal notranslate"><span class="pre">tune_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.fit_resamples"><code class="docutils literal notranslate"><span class="pre">fit_resamples()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/tune.html#grid-generation">Grid Generation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.grid_regular"><code class="docutils literal notranslate"><span class="pre">grid_regular()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.grid_random"><code class="docutils literal notranslate"><span class="pre">grid_random()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/tune.html#finalization">Finalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/tune.html#py_tune.finalize_workflow"><code class="docutils literal notranslate"><span class="pre">finalize_workflow()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/tune.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/tune.html#basic-tuning">Basic Tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/tune.html#analyze-results">Analyze Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/tune.html#finalize-workflow">Finalize Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/tune.html#random-grid">Random Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/tune.html#fit-resamples-without-tuning">Fit Resamples Without Tuning</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/workflowsets.html">py-workflowsets: Multi-Model Comparison</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/workflowsets.html#core-classes">Core Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/workflowsets.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflowsets.html#basic-workflow-set">Basic Workflow Set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflowsets.html#evaluate-workflows">Evaluate Workflows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflowsets.html#select-best-workflow">Select Best Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflowsets.html#from-explicit-workflows">From Explicit Workflows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/workflowsets.html#access-individual-workflows">Access Individual Workflows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/visualize.html">py-visualize: Interactive Visualizations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/visualize.html#main-functions">Main Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/visualize.html#forecast-visualization">Forecast Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/visualize.html#residual-diagnostics">Residual Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/visualize.html#model-comparison">Model Comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/visualize.html#decomposition-plots">Decomposition Plots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/visualize.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/visualize.html#forecast-plot">Forecast Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/visualize.html#id1">Residual Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/visualize.html#id2">Model Comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/visualize.html#decomposition-plot">Decomposition Plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/visualize.html#customization">Customization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/stacks.html">py-stacks: Model Ensembling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/stacks.html#core-classes">Core Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/stacks.html#main-functions">Main Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/stacks.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/stacks.html#basic-stacking">Basic Stacking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/stacks.html#model-weights">Model Weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/stacks.html#non-negative-weights">Non-Negative Weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/stacks.html#cross-validation-stacking">Cross-Validation Stacking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/stacks.html#evaluate-stack">Evaluate Stack</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../models/linear_models.html">Linear Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../models/linear_models.html#linear-reg">linear_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/linear_models.html#poisson-reg">poisson_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/linear_models.html#gen-additive-mod">gen_additive_mod()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/linear_models.html#when-to-use">When to Use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/linear_models.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../models/tree_models.html">Tree-Based Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../models/tree_models.html#decision-tree">decision_tree()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/tree_models.html#rand-forest">rand_forest()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/tree_models.html#boost-tree">boost_tree()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/tree_models.html#when-to-use">When to Use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/tree_models.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../models/time_series.html">Time Series Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../models/time_series.html#arima-reg">arima_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/time_series.html#prophet-reg">prophet_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/time_series.html#exp-smoothing">exp_smoothing()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/time_series.html#seasonal-reg">seasonal_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/time_series.html#recursive-reg">recursive_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/time_series.html#hybrid-models">Hybrid Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../models/time_series.html#arima-boost">arima_boost()</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../models/time_series.html#prophet-boost">prophet_boost()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../models/time_series.html#when-to-use">When to Use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/time_series.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../models/ensemble_models.html">Ensemble Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../models/ensemble_models.html#boost-tree">boost_tree()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/ensemble_models.html#hybrid-time-series">Hybrid Time Series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../models/ensemble_models.html#arima-boost">arima_boost()</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../models/ensemble_models.html#prophet-boost">prophet_boost()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../models/ensemble_models.html#model-stacking">Model Stacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/ensemble_models.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../models/baseline_models.html">Baseline Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../models/baseline_models.html#null-model">null_model()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/baseline_models.html#naive-reg">naive_reg()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/baseline_models.html#when-to-use">When to Use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../models/baseline_models.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/basic_regression.html">Basic Regression Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/basic_regression.html#simple-linear-regression">Simple Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/basic_regression.html#with-feature-engineering">With Feature Engineering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/basic_regression.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/time_series_forecasting.html">Time Series Forecasting Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/time_series_forecasting.html#prophet-forecasting">Prophet Forecasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/time_series_forecasting.html#arima-forecasting">ARIMA Forecasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/time_series_forecasting.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/hyperparameter_tuning.html">Hyperparameter Tuning Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/hyperparameter_tuning.html#grid-search">Grid Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/hyperparameter_tuning.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/panel_models.html">Panel/Grouped Model Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/panel_models.html#nested-approach">Nested Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/panel_models.html#global-approach">Global Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/panel_models.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/model_stacking.html">Model Stacking Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/model_stacking.html#basic-stacking">Basic Stacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/model_stacking.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/contributing.html">Contributing Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/contributing.html#development-setup">Development Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/contributing.html#running-tests">Running Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/contributing.html#code-style">Code Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/contributing.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/contributing.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../development/architecture.html">Architecture Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/architecture.html#layers">Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/architecture.html#key-patterns">Key Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/architecture.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../development/testing.html">Testing Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/testing.html#test-structure">Test Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/testing.html#running-tests">Running Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/testing.html#test-coverage">Test Coverage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/testing.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../development/changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/changelog.html#version-0-1-0-current">Version 0.1.0 (Current)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/changelog.html#see-also">See Also</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">py-tidymodels</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">py_recipes.recipe</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for py_recipes.recipe</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Core Recipe and PreparedRecipe classes for feature engineering</span>

<span class="sd">Recipes specify a sequence of preprocessing steps to be applied to data.</span>
<span class="sd">They are fitted on training data (prep) and then applied to new data (bake).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Protocol</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Literal</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_datetime_columns</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get list of datetime columns in dataframe.</span>

<span class="sd">    Used internally to exclude datetime columns from normalization/scaling</span>
<span class="sd">    operations, as these should be handled by specialized time feature</span>
<span class="sd">    extraction steps instead.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: DataFrame to check for datetime columns</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of column names with datetime dtype</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>
            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_datetime64_any_dtype</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">])]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">RecipeStep</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Protocol for recipe steps.</span>

<span class="sd">    All recipe steps must implement prep() and return a PreparedStep.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PreparedStep&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit the step to training data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: Training data</span>
<span class="sd">            training: Whether this is training data (vs application)</span>

<span class="sd">        Returns:</span>
<span class="sd">            PreparedStep ready to bake new data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PreparedStep</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Protocol for fitted recipe steps.</span>

<span class="sd">    All prepared steps must implement bake() to transform data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bake</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the fitted transformation to new data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: Data to transform</span>

<span class="sd">        Returns:</span>
<span class="sd">            Transformed DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>


<div class="viewcode-block" id="Recipe">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Recipe</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Feature engineering specification.</span>

<span class="sd">    A Recipe is a specification of preprocessing steps that can be:</span>
<span class="sd">    1. Fitted to training data via prep()</span>
<span class="sd">    2. Applied to new data via PreparedRecipe.bake()</span>

<span class="sd">    Recipes ensure consistent preprocessing between training and test data,</span>
<span class="sd">    preventing data leakage.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        steps: List of RecipeStep objects to apply</span>
<span class="sd">        template: Optional template DataFrame for role inference</span>
<span class="sd">        roles: Dictionary mapping role names to column lists</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Create recipe</span>
<span class="sd">        &gt;&gt;&gt; rec = (</span>
<span class="sd">        ...     Recipe()</span>
<span class="sd">        ...     .step_normalize([&quot;feature1&quot;, &quot;feature2&quot;])</span>
<span class="sd">        ...     .step_dummy([&quot;category&quot;])</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Fit to training data</span>
<span class="sd">        &gt;&gt;&gt; rec_fit = rec.prep(train_data)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Apply to test data</span>
<span class="sd">        &gt;&gt;&gt; test_transformed = rec_fit.bake(test_data)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">steps</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">template</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">roles</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

<div class="viewcode-block" id="Recipe.add_step">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.add_step">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span> <span class="n">RecipeStep</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a preprocessing step to the recipe.</span>

<span class="sd">        Args:</span>
<span class="sd">            step: RecipeStep to add</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="Recipe.step_rm">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_rm">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_rm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove/drop columns from the dataset.</span>

<span class="sd">        This step removes specified columns from the data. Useful for</span>
<span class="sd">        removing columns that shouldn&#39;t be used in modeling (like IDs, dates,</span>
<span class="sd">        or other non-predictive features).</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Column(s) to remove. Can be a string, list of strings,</span>
<span class="sd">                    or selector function</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Remove single column</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_rm(&quot;date&quot;)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Remove multiple columns</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_rm([&quot;id&quot;, &quot;date&quot;, &quot;timestamp&quot;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.remove</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepRm</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepRm</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select (keep) only specified columns from the dataset.</span>

<span class="sd">        This is the inverse of step_rm() - it keeps only the specified</span>
<span class="sd">        columns and removes everything else.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Column(s) to keep. Can be a string, list of strings,</span>
<span class="sd">                    or selector function</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Keep only specific columns</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select([&quot;feature1&quot;, &quot;feature2&quot;, &quot;target&quot;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.remove</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelect</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelect</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_normalize">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_normalize">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_normalize</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;zscore&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalize numeric columns.</span>

<span class="sd">        Centers and scales numeric features using StandardScaler (zscore)</span>
<span class="sd">        or MinMaxScaler (minmax).</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to normalize (None = all numeric)</span>
<span class="sd">            method: Normalization method (&quot;zscore&quot; or &quot;minmax&quot;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_normalize([&quot;feature1&quot;, &quot;feature2&quot;])</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_normalize(method=&quot;minmax&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.normalize</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepNormalize</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepNormalize</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_dummy">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_dummy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_dummy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">],</span>
        <span class="n">one_hot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create dummy variables from categorical columns.</span>

<span class="sd">        Converts categorical variables to numeric using one-hot encoding</span>
<span class="sd">        or integer encoding.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Categorical columns to encode (list or selector function)</span>
<span class="sd">            one_hot: Use one-hot encoding (True) or integer encoding (False)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_dummy([&quot;category&quot;, &quot;group&quot;])</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_dummy(all_nominal_predictors())</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.dummy</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepDummy</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepDummy</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">one_hot</span><span class="o">=</span><span class="n">one_hot</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_impute_mean">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_impute_mean">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_impute_mean</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Impute missing values using mean.</span>

<span class="sd">        Replaces NA values in numeric columns with the training mean.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to impute (None = all numeric with NA)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_impute_mean([&quot;feature1&quot;, &quot;feature2&quot;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepImputeMean</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepImputeMean</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_impute_median">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_impute_median">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_impute_median</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Impute missing values using median.</span>

<span class="sd">        Replaces NA values in numeric columns with the training median.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to impute (None = all numeric with NA)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepImputeMedian</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepImputeMedian</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_mutate">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_mutate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_mutate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">transformations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">callable</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create or modify columns using custom functions.</span>

<span class="sd">        Args:</span>
<span class="sd">            transformations: Dict mapping column names to transformation functions</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_mutate({</span>
<span class="sd">            ...     &quot;log_feature&quot;: lambda df: np.log(df[&quot;feature&quot;] + 1),</span>
<span class="sd">            ...     &quot;interaction&quot;: lambda df: df[&quot;x1&quot;] * df[&quot;x2&quot;]</span>
<span class="sd">            ... })</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.mutate</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepMutate</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepMutate</span><span class="p">(</span><span class="n">transformations</span><span class="o">=</span><span class="n">transformations</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_lag">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_lag">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_lag</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">lags</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create lag features for time series data.</span>

<span class="sd">        Creates lagged versions of specified columns to capture temporal patterns.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to create lags for</span>
<span class="sd">            lags: List of lag periods (e.g., [1, 2, 7] for 1-day, 2-day, 7-day lags)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_lag([&quot;sales&quot;, &quot;price&quot;], lags=[1, 7, 30])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepLag</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepLag</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_diff">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_diff">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_diff</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">lag</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">differences</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create differenced features.</span>

<span class="sd">        Computes differences between consecutive observations to make</span>
<span class="sd">        time series stationary.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to difference (None = all numeric)</span>
<span class="sd">            lag: Period for differencing (default 1)</span>
<span class="sd">            differences: Number of times to difference (default 1)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_diff([&quot;sales&quot;], lag=1)</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_diff([&quot;price&quot;], lag=7, differences=2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepDiff</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepDiff</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="n">lag</span><span class="p">,</span> <span class="n">differences</span><span class="o">=</span><span class="n">differences</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_pct_change">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_pct_change">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_pct_change</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">periods</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create percent change features.</span>

<span class="sd">        Computes percentage changes between consecutive observations.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to compute percent changes for (None = all numeric)</span>
<span class="sd">            periods: Number of periods for change calculation (default 1)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_pct_change([&quot;sales&quot;, &quot;revenue&quot;])</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_pct_change([&quot;price&quot;], periods=7)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepPctChange</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepPctChange</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">periods</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_rolling">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_rolling">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_rolling</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">stats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create rolling window statistics.</span>

<span class="sd">        Computes statistics over rolling windows (mean, std, min, max, sum).</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to compute rolling stats for</span>
<span class="sd">            window: Size of rolling window</span>
<span class="sd">            stats: Statistics to compute (default [&quot;mean&quot;])</span>
<span class="sd">                   Options: &quot;mean&quot;, &quot;std&quot;, &quot;min&quot;, &quot;max&quot;, &quot;sum&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_rolling([&quot;sales&quot;], window=7, stats=[&quot;mean&quot;, &quot;std&quot;])</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_rolling([&quot;price&quot;], window=30, stats=[&quot;min&quot;, &quot;max&quot;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepRolling</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepRolling</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="n">stats</span><span class="o">=</span><span class="n">stats</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_date">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_date">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_date</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract date/time features from datetime columns.</span>

<span class="sd">        Creates features like year, month, day, dayofweek, quarter, etc.</span>

<span class="sd">        Args:</span>
<span class="sd">            column: Datetime column to extract features from</span>
<span class="sd">            features: List of features to extract (default [&quot;year&quot;, &quot;month&quot;, &quot;day&quot;, &quot;dayofweek&quot;])</span>
<span class="sd">                     Options: &quot;year&quot;, &quot;month&quot;, &quot;day&quot;, &quot;dayofweek&quot;, &quot;dayofyear&quot;, &quot;quarter&quot;,</span>
<span class="sd">                             &quot;week&quot;, &quot;hour&quot;, &quot;minute&quot;, &quot;is_weekend&quot;, &quot;is_month_start&quot;,</span>
<span class="sd">                             &quot;is_month_end&quot;, &quot;is_quarter_start&quot;, &quot;is_quarter_end&quot;,</span>
<span class="sd">                             &quot;is_year_start&quot;, &quot;is_year_end&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_date(&quot;date&quot;, features=[&quot;year&quot;, &quot;month&quot;, &quot;dayofweek&quot;])</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_date(&quot;timestamp&quot;, features=[&quot;hour&quot;, &quot;is_weekend&quot;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepDate</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepDate</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_pca">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_pca">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_pca</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_comp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Principal Component Analysis (PCA) transformation.</span>

<span class="sd">        Reduces dimensionality by projecting data onto principal components.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to apply PCA to (None = all numeric)</span>
<span class="sd">            num_comp: Number of components to keep</span>
<span class="sd">            threshold: Variance threshold (alternative to num_comp)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_pca(num_comp=5)</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_pca([&quot;x1&quot;, &quot;x2&quot;, &quot;x3&quot;], num_comp=2)</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_pca(threshold=0.95)  # Keep 95% of variance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepPCA</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepPCA</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">num_comp</span><span class="o">=</span><span class="n">num_comp</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_corr">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_corr">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_corr</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multicollinearity&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features based on correlation.</span>

<span class="sd">        Removes features with low correlation to the outcome variable or</span>
<span class="sd">        high correlation with other predictors (multicollinearity).</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Outcome column name</span>
<span class="sd">            threshold: Correlation threshold (default 0.9 for multicollinearity)</span>
<span class="sd">            method: Selection method - &quot;multicollinearity&quot; or &quot;outcome&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Remove highly correlated predictors</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_select_corr(&quot;sales&quot;, threshold=0.9, method=&quot;multicollinearity&quot;)</span>
<span class="sd">            &gt;&gt;&gt; # Keep only features correlated with outcome</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_select_corr(&quot;sales&quot;, threshold=0.3, method=&quot;outcome&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectCorr</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectCorr</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">))</span></div>


    <span class="c1"># ========== Transformation Steps ==========</span>

<div class="viewcode-block" id="Recipe.step_log">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_log">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_log</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">base</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">,</span>
        <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">signed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply logarithmic transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to transform (None = all numeric)</span>
<span class="sd">            base: Logarithm base (default: natural log)</span>
<span class="sd">            offset: Value added before transformation (default: 0)</span>
<span class="sd">            signed: If True, preserves sign (default: False)</span>
<span class="sd">            inplace: If True, replace original columns; if False, create new columns with suffix (default: True)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepLog</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepLog</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="n">signed</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_sqrt">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_sqrt">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_sqrt</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply square root transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to transform (None = all numeric)</span>
<span class="sd">            inplace: If True, replace original columns; if False, create new columns with suffix (default: True)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSqrt</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSqrt</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_boxcox">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_boxcox">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_boxcox</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">lambdas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply Box-Cox power transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to transform (None = all numeric)</span>
<span class="sd">            lambdas: Optional dict of lambda parameters</span>
<span class="sd">            inplace: If True, replace original columns; if False, create new columns with suffix (default: True)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepBoxCox</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepBoxCox</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">lambdas</span><span class="o">=</span><span class="n">lambdas</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_yeojohnson">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_yeojohnson">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_yeojohnson</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">lambdas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply Yeo-Johnson power transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to transform (None = all numeric)</span>
<span class="sd">            lambdas: Optional dict of lambda parameters</span>
<span class="sd">            inplace: If True, replace original columns; if False, create new columns with suffix (default: True)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepYeoJohnson</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepYeoJohnson</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">lambdas</span><span class="o">=</span><span class="n">lambdas</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_inverse">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_inverse">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_inverse</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply inverse transformation (1/x).</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to transform (None = all numeric)</span>
<span class="sd">            offset: Value added before inversion to avoid division by zero (default: 0)</span>
<span class="sd">            inplace: If True, replace original columns; if False, create new columns with suffix (default: True)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepInverse</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepInverse</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">))</span></div>


    <span class="c1"># ========== Scaling Steps ==========</span>

<div class="viewcode-block" id="Recipe.step_center">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_center">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_center</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Center numeric columns to have mean zero.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to center (None = all numeric)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.scaling</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepCenter</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepCenter</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_scale">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_scale">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_scale</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scale numeric columns to have standard deviation of one.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to scale (None = all numeric)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.scaling</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepScale</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepScale</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_range">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_range">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_range</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">min_val</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">max_val</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scale numeric columns to a custom range.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to scale (None = all numeric)</span>
<span class="sd">            min_val: Minimum value of scaled range</span>
<span class="sd">            max_val: Maximum value of scaled range</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.scaling</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepRange</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepRange</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">min_val</span><span class="o">=</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="o">=</span><span class="n">max_val</span><span class="p">))</span></div>


    <span class="c1"># ========== Filter Steps ==========</span>

<div class="viewcode-block" id="Recipe.step_zv">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_zv">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_zv</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove zero variance columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to check (None = all numeric)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filters</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepZv</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepZv</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_nzv">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_nzv">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_nzv</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">freq_cut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">19.0</span><span class="p">,</span>
        <span class="n">unique_cut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove near-zero variance columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to check (None = all numeric)</span>
<span class="sd">            freq_cut: Frequency ratio threshold</span>
<span class="sd">            unique_cut: Unique value percentage threshold</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filters</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepNzv</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepNzv</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">freq_cut</span><span class="o">=</span><span class="n">freq_cut</span><span class="p">,</span> <span class="n">unique_cut</span><span class="o">=</span><span class="n">unique_cut</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_lincomb">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_lincomb">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_lincomb</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove linearly dependent columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to check (None = all numeric)</span>
<span class="sd">            threshold: Tolerance for linear dependency detection</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filters</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepLinComb</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepLinComb</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_filter_missing">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_filter_missing">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_filter_missing</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove columns with high proportion of missing values.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to check (None = all columns)</span>
<span class="sd">            threshold: Maximum proportion of missing values</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filters</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepFilterMissing</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepFilterMissing</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_filter_anova">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_filter_anova">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_filter_anova</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_pvalue</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter features using ANOVA F-test.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Outcome column name</span>
<span class="sd">            threshold: Minimum score to keep (either F-statistic or -log10(p-value))</span>
<span class="sd">            top_n: Keep top N features</span>
<span class="sd">            top_p: Keep top proportion of features (0-1)</span>
<span class="sd">            use_pvalue: Use -log10(p-value) if True, else F-statistic</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filter_supervised</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepFilterAnova</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepFilterAnova</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span> <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span> <span class="n">use_pvalue</span><span class="o">=</span><span class="n">use_pvalue</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_filter_rf_importance">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_filter_rf_importance">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_filter_rf_importance</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">trees</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">mtry</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">min_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter features using Random Forest feature importance.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Outcome column name</span>
<span class="sd">            threshold: Minimum importance score to keep</span>
<span class="sd">            top_n: Keep top N features</span>
<span class="sd">            top_p: Keep top proportion of features (0-1)</span>
<span class="sd">            trees: Number of trees in random forest</span>
<span class="sd">            mtry: Number of variables to sample at each split</span>
<span class="sd">            min_n: Minimum number of samples in leaf nodes</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filter_supervised</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepFilterRfImportance</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepFilterRfImportance</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span> <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span>
            <span class="n">trees</span><span class="o">=</span><span class="n">trees</span><span class="p">,</span> <span class="n">mtry</span><span class="o">=</span><span class="n">mtry</span><span class="p">,</span> <span class="n">min_n</span><span class="o">=</span><span class="n">min_n</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_filter_mutual_info">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_filter_mutual_info">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_filter_mutual_info</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_neighbors</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter features using mutual information (information gain).</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Outcome column name</span>
<span class="sd">            threshold: Minimum mutual information score to keep</span>
<span class="sd">            top_n: Keep top N features</span>
<span class="sd">            top_p: Keep top proportion of features (0-1)</span>
<span class="sd">            n_neighbors: Number of neighbors for MI estimation</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filter_supervised</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepFilterMutualInfo</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepFilterMutualInfo</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span> <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_filter_roc_auc">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_filter_roc_auc">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_filter_roc_auc</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">multiclass_strategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ovr&#39;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter features using ROC AUC scores (classification only).</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Outcome column name</span>
<span class="sd">            threshold: Minimum ROC AUC score to keep</span>
<span class="sd">            top_n: Keep top N features</span>
<span class="sd">            top_p: Keep top proportion of features (0-1)</span>
<span class="sd">            multiclass_strategy: &#39;ovr&#39; (one-vs-rest) or &#39;ovo&#39; (one-vs-one)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filter_supervised</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepFilterRocAuc</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepFilterRocAuc</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span> <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span>
            <span class="n">multiclass_strategy</span><span class="o">=</span><span class="n">multiclass_strategy</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_filter_chisq">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_filter_chisq">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_filter_chisq</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;chisq&#39;</span><span class="p">,</span>
        <span class="n">use_pvalue</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter features using chi-squared or Fisher exact test.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Outcome column name</span>
<span class="sd">            threshold: Minimum score to keep</span>
<span class="sd">            top_n: Keep top N features</span>
<span class="sd">            top_p: Keep top proportion of features (0-1)</span>
<span class="sd">            method: &#39;chisq&#39; or &#39;fisher&#39;</span>
<span class="sd">            use_pvalue: Use -log10(p-value) if True, else test statistic</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filter_supervised</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepFilterChisq</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepFilterChisq</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span> <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">use_pvalue</span><span class="o">=</span><span class="n">use_pvalue</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_shap">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_shap">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_shap</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">shap_samples</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter features using SHAP (SHapley Additive exPlanations) values.</span>

<span class="sd">        Uses SHAP values to measure feature importance. Works with tree-based</span>
<span class="sd">        models (fast TreeExplainer) and other models (slower KernelExplainer).</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Outcome column name</span>
<span class="sd">            model: Trained scikit-learn compatible model to explain</span>
<span class="sd">            threshold: Minimum absolute SHAP value to keep feature</span>
<span class="sd">            top_n: Keep top N features by mean absolute SHAP value</span>
<span class="sd">            top_p: Keep top proportion of features (0-1)</span>
<span class="sd">            shap_samples: Number of samples for SHAP calculation (None = all)</span>
<span class="sd">            random_state: Random seed for sampling</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from sklearn.ensemble import RandomForestRegressor</span>
<span class="sd">            &gt;&gt;&gt; rf = RandomForestRegressor(n_estimators=100, random_state=42)</span>
<span class="sd">            &gt;&gt;&gt; rf.fit(X_train, y_train)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe(data, &quot;price ~ .&quot;).step_select_shap(</span>
<span class="sd">            ...     outcome=&#39;price&#39;, model=rf, top_n=10, shap_samples=500</span>
<span class="sd">            ... )</span>

<span class="sd">        Notes:</span>
<span class="sd">            Requires shap package: pip install shap</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filter_supervised</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectShap</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectShap</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span> <span class="n">shap_samples</span><span class="o">=</span><span class="n">shap_samples</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_permutation">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_permutation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_permutation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_repeats</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">scoring</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter features using permutation importance.</span>

<span class="sd">        Measures feature importance by shuffling each feature and measuring</span>
<span class="sd">        the resulting decrease in model performance. Model-agnostic.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Outcome column name</span>
<span class="sd">            model: Trained scikit-learn compatible model to evaluate</span>
<span class="sd">            threshold: Minimum permutation importance to keep feature</span>
<span class="sd">            top_n: Keep top N features by permutation importance</span>
<span class="sd">            top_p: Keep top proportion of features (0-1)</span>
<span class="sd">            n_repeats: Number of times to permute each feature (default: 10)</span>
<span class="sd">            scoring: Scoring metric (e.g., &#39;r2&#39;, &#39;neg_mean_squared_error&#39;, &#39;accuracy&#39;)</span>
<span class="sd">            random_state: Random seed for reproducibility</span>
<span class="sd">            n_jobs: Number of parallel jobs (-1 = all cores)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from sklearn.ensemble import RandomForestRegressor</span>
<span class="sd">            &gt;&gt;&gt; rf = RandomForestRegressor(n_estimators=100, random_state=42)</span>
<span class="sd">            &gt;&gt;&gt; rf.fit(X_train, y_train)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe(data, &quot;price ~ .&quot;).step_select_permutation(</span>
<span class="sd">            ...     outcome=&#39;price&#39;, model=rf, top_n=15, n_repeats=10</span>
<span class="sd">            ... )</span>

<span class="sd">        Notes:</span>
<span class="sd">            Computationally expensive (n_repeats  n_features model evaluations).</span>
<span class="sd">            Parallel execution recommended for large datasets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.filter_supervised</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectPermutation</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectPermutation</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="n">n_repeats</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_genetic_algorithm">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_genetic_algorithm">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_genetic_algorithm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rmse&quot;</span><span class="p">,</span>
        <span class="n">maximize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">constraints</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mandatory_features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">forbidden_features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">population_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
        <span class="n">generations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">mutation_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">crossover_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="n">cv_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">use_nsga2</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">nsga2_objectives</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features using genetic algorithm optimization.</span>

<span class="sd">        Uses a genetic algorithm to find an optimal subset of features that</span>
<span class="sd">        maximizes model performance. Supports multi-objective optimization</span>
<span class="sd">        via NSGA-II for balancing performance, sparsity, and cost.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Outcome column name</span>
<span class="sd">            model: Parsnip model specification for fitness evaluation</span>
<span class="sd">            columns: Columns to consider (None = all numeric predictors)</span>
<span class="sd">            metric: Metric to optimize (&#39;rmse&#39;, &#39;mae&#39;, &#39;r_squared&#39;, etc.)</span>
<span class="sd">            maximize: Whether to maximize metric (True for R) or minimize (False for RMSE)</span>
<span class="sd">            top_n: Number of features to select (None = GA determines)</span>
<span class="sd">            constraints: Statistical constraints dict (p_value, vif, coef_stability, etc.)</span>
<span class="sd">            mandatory_features: Features that must be included</span>
<span class="sd">            forbidden_features: Features that must not be included</span>
<span class="sd">            population_size: GA population size (default: 50)</span>
<span class="sd">            generations: Maximum number of generations (default: 100)</span>
<span class="sd">            mutation_rate: Mutation probability (default: 0.1)</span>
<span class="sd">            crossover_rate: Crossover probability (default: 0.8)</span>
<span class="sd">            cv_folds: Cross-validation folds for fitness evaluation (default: 5)</span>
<span class="sd">            use_nsga2: Use multi-objective NSGA-II algorithm (default: False)</span>
<span class="sd">            nsga2_objectives: Objectives for NSGA-II ([&#39;performance&#39;, &#39;sparsity&#39;, &#39;cost&#39;])</span>
<span class="sd">            random_state: Random seed for reproducibility</span>
<span class="sd">            verbose: Print GA progress (default: False)</span>
<span class="sd">            **kwargs: Additional parameters (elitism, tournament_size, n_jobs, etc.)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from py_recipes import recipe</span>
<span class="sd">            &gt;&gt;&gt; from py_parsnip import linear_reg</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Basic usage: Select top 10 features optimizing RMSE</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe(data, &quot;y ~ .&quot;).step_select_genetic_algorithm(</span>
<span class="sd">            ...     outcome=&#39;y&#39;,</span>
<span class="sd">            ...     model=linear_reg(),</span>
<span class="sd">            ...     metric=&#39;rmse&#39;,</span>
<span class="sd">            ...     top_n=10,</span>
<span class="sd">            ...     generations=50</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # With statistical constraints</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe(data, &quot;y ~ .&quot;).step_select_genetic_algorithm(</span>
<span class="sd">            ...     outcome=&#39;y&#39;,</span>
<span class="sd">            ...     model=linear_reg(),</span>
<span class="sd">            ...     metric=&#39;rmse&#39;,</span>
<span class="sd">            ...     top_n=15,</span>
<span class="sd">            ...     constraints={</span>
<span class="sd">            ...         &#39;p_value&#39;: {&#39;max&#39;: 0.05, &#39;method&#39;: &#39;bonferroni&#39;},</span>
<span class="sd">            ...         &#39;vif&#39;: {&#39;max&#39;: 5.0}</span>
<span class="sd">            ...     },</span>
<span class="sd">            ...     cv_folds=5,</span>
<span class="sd">            ...     verbose=True</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Multi-objective optimization with NSGA-II</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe(data, &quot;y ~ .&quot;).step_select_genetic_algorithm(</span>
<span class="sd">            ...     outcome=&#39;y&#39;,</span>
<span class="sd">            ...     model=linear_reg(),</span>
<span class="sd">            ...     use_nsga2=True,</span>
<span class="sd">            ...     nsga2_objectives=[&#39;performance&#39;, &#39;sparsity&#39;],</span>
<span class="sd">            ...     generations=100</span>
<span class="sd">            ... )</span>

<span class="sd">        Notes:</span>
<span class="sd">            - Computationally expensive; uses CV for each chromosome evaluation</span>
<span class="sd">            - Supports parallel execution via n_jobs parameter</span>
<span class="sd">            - For large feature sets, consider using warm_start=&#39;importance&#39;</span>
<span class="sd">            - NSGA-II finds Pareto-optimal trade-offs between objectives</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.genetic_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectGeneticAlgorithm</span>

        <span class="c1"># Set defaults for optional parameters</span>
        <span class="k">if</span> <span class="n">constraints</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">constraints</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">mandatory_features</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mandatory_features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">forbidden_features</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">forbidden_features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">nsga2_objectives</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nsga2_objectives</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;performance&quot;</span><span class="p">,</span> <span class="s2">&quot;sparsity&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectGeneticAlgorithm</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
            <span class="n">maximize</span><span class="o">=</span><span class="n">maximize</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span><span class="p">,</span>
            <span class="n">mandatory_features</span><span class="o">=</span><span class="n">mandatory_features</span><span class="p">,</span>
            <span class="n">forbidden_features</span><span class="o">=</span><span class="n">forbidden_features</span><span class="p">,</span>
            <span class="n">population_size</span><span class="o">=</span><span class="n">population_size</span><span class="p">,</span>
            <span class="n">generations</span><span class="o">=</span><span class="n">generations</span><span class="p">,</span>
            <span class="n">mutation_rate</span><span class="o">=</span><span class="n">mutation_rate</span><span class="p">,</span>
            <span class="n">crossover_rate</span><span class="o">=</span><span class="n">crossover_rate</span><span class="p">,</span>
            <span class="n">cv_folds</span><span class="o">=</span><span class="n">cv_folds</span><span class="p">,</span>
            <span class="n">use_nsga2</span><span class="o">=</span><span class="n">use_nsga2</span><span class="p">,</span>
            <span class="n">nsga2_objectives</span><span class="o">=</span><span class="n">nsga2_objectives</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_splitwise">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_splitwise">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_splitwise</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">transformation_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;univariate&#39;</span><span class="p">,</span>
        <span class="n">min_support</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">min_improvement</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="n">criterion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;AIC&#39;</span><span class="p">,</span>
        <span class="n">feature_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;dummies&#39;</span><span class="p">,</span>
        <span class="n">exclude_vars</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adaptive dummy encoding for numeric predictors using shallow decision trees.</span>

<span class="sd">        SplitWise automatically transforms numeric predictors into either binary</span>
<span class="sd">        dummy variables (with 1 or 2 split points) or keeps them linear based on</span>
<span class="sd">        AIC/BIC improvement. This is a supervised transformation step.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Outcome column name (required for supervised transformation)</span>
<span class="sd">            transformation_mode: &#39;univariate&#39; (independent) or &#39;iterative&#39; (adaptive)</span>
<span class="sd">            min_support: Minimum fraction of observations in each dummy group (0-0.5)</span>
<span class="sd">            min_improvement: Minimum AIC/BIC improvement to prefer dummy over linear</span>
<span class="sd">            criterion: &#39;AIC&#39; or &#39;BIC&#39; for model selection</span>
<span class="sd">            feature_type: &#39;dummies&#39; (binary only), &#39;interactions&#39; (dummy*value), or &#39;both&#39;</span>
<span class="sd">            exclude_vars: Variables forced to stay linear (no transformation)</span>
<span class="sd">            columns: Columns to consider (None = all numeric except outcome)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Basic usage - dummies only</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_splitwise(outcome=&#39;price&#39;)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # With interactions</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_splitwise(</span>
<span class="sd">            ...     outcome=&#39;sales&#39;,</span>
<span class="sd">            ...     feature_type=&#39;interactions&#39;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Both dummies and interactions</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_splitwise(</span>
<span class="sd">            ...     outcome=&#39;price&#39;,</span>
<span class="sd">            ...     feature_type=&#39;both&#39;,</span>
<span class="sd">            ...     min_support=0.15</span>
<span class="sd">            ... )</span>

<span class="sd">        References:</span>
<span class="sd">            Kurbucz et al. (2025). SplitWise Regression: Stepwise Modeling with</span>
<span class="sd">            Adaptive Dummy Encoding. arXiv:2505.15423</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.splitwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSplitwise</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSplitwise</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">transformation_mode</span><span class="o">=</span><span class="n">transformation_mode</span><span class="p">,</span>
            <span class="n">min_support</span><span class="o">=</span><span class="n">min_support</span><span class="p">,</span>
            <span class="n">min_improvement</span><span class="o">=</span><span class="n">min_improvement</span><span class="p">,</span>
            <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
            <span class="n">feature_type</span><span class="o">=</span><span class="n">feature_type</span><span class="p">,</span>
            <span class="n">exclude_vars</span><span class="o">=</span><span class="n">exclude_vars</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_safe">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_safe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_safe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">surrogate_model</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">penalty</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="n">pelt_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;l2&#39;</span><span class="p">,</span>
        <span class="n">no_changepoint_strategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span>
        <span class="n">feature_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;dummies&#39;</span><span class="p">,</span>
        <span class="n">keep_original_cols</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">grid_resolution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Surrogate Assisted Feature Extraction (SAFE) for interpretable models.</span>

<span class="sd">        SAFE uses a complex surrogate model to guide feature transformation,</span>
<span class="sd">        creating interpretable features by:</span>
<span class="sd">        - Detecting changepoints in numeric variable partial dependence plots</span>
<span class="sd">        - Merging similar categorical levels via hierarchical clustering</span>

<span class="sd">        The transformed features retain information from the complex surrogate</span>
<span class="sd">        while being more interpretable for simpler models.</span>

<span class="sd">        Args:</span>
<span class="sd">            surrogate_model: Pre-fitted surrogate model (e.g., GradientBoostingRegressor)</span>
<span class="sd">                Must implement predict() for regression or predict_proba() for classification</span>
<span class="sd">            outcome: Name of outcome variable (required for supervised transformation)</span>
<span class="sd">            penalty: Penalty for adding changepoints (default: 3.0).</span>
<span class="sd">                Higher values = fewer intervals. Typical range: 0.1-10.0</span>
<span class="sd">            pelt_model: Cost function for Pelt algorithm (&#39;l2&#39;, &#39;l1&#39;, &#39;rbf&#39;)</span>
<span class="sd">            no_changepoint_strategy: Strategy when no changepoint detected:</span>
<span class="sd">                - &#39;median&#39;: Create one split at median</span>
<span class="sd">                - &#39;drop&#39;: Remove feature from output</span>
<span class="sd">            feature_type: &#39;dummies&#39; (binary only), &#39;interactions&#39; (dummy*value), or &#39;both&#39;</span>
<span class="sd">            keep_original_cols: Whether to keep original columns alongside</span>
<span class="sd">                transformed features (default: False)</span>
<span class="sd">            top_n: If specified, select only top N most important transformed</span>
<span class="sd">                features based on variance explained in surrogate predictions</span>
<span class="sd">            grid_resolution: Number of points for partial dependence grid (default: 1000)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step_safe added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from sklearn.ensemble import GradientBoostingRegressor</span>
<span class="sd">            &gt;&gt;&gt; surrogate = GradientBoostingRegressor(n_estimators=100)</span>
<span class="sd">            &gt;&gt;&gt; surrogate.fit(train_data.drop(&#39;target&#39;, axis=1), train_data[&#39;target&#39;])</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Basic usage - dummies only</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_safe(</span>
<span class="sd">            ...     surrogate_model=surrogate,</span>
<span class="sd">            ...     outcome=&#39;target&#39;,</span>
<span class="sd">            ...     penalty=3.0</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # With interactions</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_safe(</span>
<span class="sd">            ...     surrogate_model=surrogate,</span>
<span class="sd">            ...     outcome=&#39;target&#39;,</span>
<span class="sd">            ...     feature_type=&#39;interactions&#39;,</span>
<span class="sd">            ...     top_n=10</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Both dummies and interactions</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_safe(</span>
<span class="sd">            ...     surrogate_model=surrogate,</span>
<span class="sd">            ...     outcome=&#39;target&#39;,</span>
<span class="sd">            ...     feature_type=&#39;both&#39;</span>
<span class="sd">            ... )</span>

<span class="sd">        Notes:</span>
<span class="sd">            - Requires ruptures, scipy, and kneed packages</span>
<span class="sd">            - Surrogate model must be pre-fitted</span>
<span class="sd">            - Numeric features: changepoint detection via Pelt algorithm</span>
<span class="sd">            - Categorical features: hierarchical clustering (Ward linkage)</span>
<span class="sd">            - Output is one-hot encoded with p-1 scheme</span>

<span class="sd">        References:</span>
<span class="sd">            SAFE library: https://github.com/ModelOriented/SAFE</span>

<span class="sd">        Deprecation:</span>
<span class="sd">            step_safe() now uses StepSafeV2 internally. Parameters pelt_model and</span>
<span class="sd">            no_changepoint_strategy are ignored. Consider using step_safe_v2() directly</span>
<span class="sd">            for more control and clarity.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_extraction</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSafeV2</span>

        <span class="c1"># Deprecation warning</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;step_safe() is deprecated and now uses step_safe_v2() internally. &quot;</span>
            <span class="s2">&quot;Parameters &#39;pelt_model&#39; and &#39;no_changepoint_strategy&#39; are ignored. &quot;</span>
            <span class="s2">&quot;Consider using step_safe_v2() directly for more control. &quot;</span>
            <span class="s2">&quot;Old step_safe() with PELT will be removed in a future version.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>

        <span class="c1"># Parameter mapping:</span>
        <span class="c1"># - Old feature_type (dummies/interactions/both)  new output_mode</span>
        <span class="c1"># - Set new feature_type=&#39;both&#39; (always process numeric + categorical)</span>
        <span class="c1"># - Ignore pelt_model and no_changepoint_strategy (not in V2)</span>

        <span class="c1"># Map penalty default: old=3.0, new=10.0</span>
        <span class="c1"># If user didn&#39;t specify (using default 3.0), use new default 10.0</span>
        <span class="k">if</span> <span class="n">penalty</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">:</span>
            <span class="n">penalty_v2</span> <span class="o">=</span> <span class="mf">10.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">penalty_v2</span> <span class="o">=</span> <span class="n">penalty</span>

        <span class="c1"># Map grid_resolution default: old=1000, new=100</span>
        <span class="k">if</span> <span class="n">grid_resolution</span> <span class="o">==</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="n">grid_resolution_v2</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">grid_resolution_v2</span> <span class="o">=</span> <span class="n">grid_resolution</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSafeV2</span><span class="p">(</span>
            <span class="n">surrogate_model</span><span class="o">=</span><span class="n">surrogate_model</span><span class="p">,</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">penalty</span><span class="o">=</span><span class="n">penalty_v2</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">max_thresholds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># V2 default</span>
            <span class="n">keep_original_cols</span><span class="o">=</span><span class="n">keep_original_cols</span><span class="p">,</span>
            <span class="n">grid_resolution</span><span class="o">=</span><span class="n">grid_resolution_v2</span><span class="p">,</span>
            <span class="n">feature_type</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>  <span class="c1"># V2: process both numeric and categorical</span>
            <span class="n">output_mode</span><span class="o">=</span><span class="n">feature_type</span><span class="p">,</span>  <span class="c1"># OLD feature_type  NEW output_mode</span>
            <span class="n">columns</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_safe_v2">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_safe_v2">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_safe_v2</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">surrogate_model</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">penalty</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_thresholds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">keep_original_cols</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">grid_resolution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">feature_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">output_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;dummies&#39;</span><span class="p">,</span>
        <span class="n">importance_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;lasso&#39;</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SAFE v2: Surrogate Assisted Feature Extraction with UNFITTED model.</span>

<span class="sd">        This version accepts an UNFITTED surrogate model (fitted during prep()),</span>
<span class="sd">        adds max_thresholds parameter to control threshold quantity, sanitizes</span>
<span class="sd">        feature names for compatibility, and recalculates importances</span>
<span class="sd">        on TRANSFORMED features using multiple methods.</span>

<span class="sd">        Key differences from step_safe:</span>
<span class="sd">        - Accepts UNFITTED surrogate model (fitted during prep)</span>
<span class="sd">        - Adds max_thresholds parameter (default=5)</span>
<span class="sd">        - Sanitizes feature names with regex</span>
<span class="sd">        - Recalculates importances on TRANSFORMED features using lasso/ridge/permutation/hybrid</span>

<span class="sd">        Args:</span>
<span class="sd">            surrogate_model: UNFITTED sklearn-compatible model (will be fitted during prep)</span>
<span class="sd">            outcome: Name of outcome variable (required)</span>
<span class="sd">            penalty: Changepoint penalty (default: 10.0). Higher = fewer thresholds</span>
<span class="sd">            top_n: Select top N most important TRANSFORMED features (None = keep all)</span>
<span class="sd">            max_thresholds: Maximum thresholds per numeric feature (default: 5)</span>
<span class="sd">            keep_original_cols: Keep original features alongside transformations (default: True)</span>
<span class="sd">            grid_resolution: PDP grid points (default: 100)</span>
<span class="sd">            feature_type: Which variable types to process - &#39;numeric&#39;, &#39;categorical&#39;, or &#39;both&#39; (default: &#39;both&#39;)</span>
<span class="sd">            output_mode: Type of features to create - &#39;dummies&#39;, &#39;interactions&#39;, or &#39;both&#39; (default: &#39;dummies&#39;)</span>
<span class="sd">            importance_method: Method for feature importance - &#39;lasso&#39;, &#39;ridge&#39;, &#39;permutation&#39;, or &#39;hybrid&#39; (default: &#39;lasso&#39;)</span>
<span class="sd">            columns: Which columns to transform (None = all except outcome)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step_safe_v2 added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from sklearn.ensemble import GradientBoostingRegressor</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # UNFITTED model - fitted during prep()</span>
<span class="sd">            &gt;&gt;&gt; surrogate = GradientBoostingRegressor(n_estimators=100)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Basic usage</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_safe_v2(</span>
<span class="sd">            ...     surrogate_model=surrogate,</span>
<span class="sd">            ...     outcome=&#39;target&#39;,</span>
<span class="sd">            ...     penalty=10.0,</span>
<span class="sd">            ...     max_thresholds=5</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Select top 10 most important transformed features</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_safe_v2(</span>
<span class="sd">            ...     surrogate_model=surrogate,</span>
<span class="sd">            ...     outcome=&#39;target&#39;,</span>
<span class="sd">            ...     top_n=10,</span>
<span class="sd">            ...     keep_original_cols=False</span>
<span class="sd">            ... )</span>

<span class="sd">        Notes:</span>
<span class="sd">            - Requires ruptures package (pip install ruptures)</span>
<span class="sd">            - Surrogate model fitted during prep() - do NOT fit beforehand</span>
<span class="sd">            - Creates binary threshold features (feature &gt; threshold)</span>
<span class="sd">            - Feature names sanitized for compatibility</span>
<span class="sd">            - Importances calculated on TRANSFORMED features using lasso/ridge/permutation/hybrid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_extraction</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSafeV2</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSafeV2</span><span class="p">(</span>
            <span class="n">surrogate_model</span><span class="o">=</span><span class="n">surrogate_model</span><span class="p">,</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">penalty</span><span class="o">=</span><span class="n">penalty</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">max_thresholds</span><span class="o">=</span><span class="n">max_thresholds</span><span class="p">,</span>
            <span class="n">keep_original_cols</span><span class="o">=</span><span class="n">keep_original_cols</span><span class="p">,</span>
            <span class="n">grid_resolution</span><span class="o">=</span><span class="n">grid_resolution</span><span class="p">,</span>
            <span class="n">feature_type</span><span class="o">=</span><span class="n">feature_type</span><span class="p">,</span>
            <span class="n">output_mode</span><span class="o">=</span><span class="n">output_mode</span><span class="p">,</span>
            <span class="n">importance_method</span><span class="o">=</span><span class="n">importance_method</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_eix">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_eix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_eix</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tree_model</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">option</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">min_gain</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">create_interactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">keep_original_cols</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        EIX - Explain Interactions in XGBoost/LightGBM for feature selection.</span>

<span class="sd">        Analyzes tree structure from XGBoost or LightGBM models to identify</span>
<span class="sd">        important variable interactions and creates interaction features based</span>
<span class="sd">        on tree model gain.</span>

<span class="sd">        Args:</span>
<span class="sd">            tree_model: Pre-fitted XGBoost or LightGBM model (REQUIRED)</span>
<span class="sd">            outcome: Outcome variable name (REQUIRED for data validation)</span>
<span class="sd">            option: What to extract - &#39;variables&#39;, &#39;interactions&#39;, or &#39;both&#39; (default: &#39;both&#39;)</span>
<span class="sd">            top_n: Select top N most important features/interactions (None = keep all)</span>
<span class="sd">            min_gain: Minimum sumGain threshold for keeping features (default: 0.0)</span>
<span class="sd">            create_interactions: Whether to create interaction features (parent  child) (default: True)</span>
<span class="sd">            keep_original_cols: Keep original columns alongside EIX features (default: False)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Notes:</span>
<span class="sd">            - Requires pre-fitted XGBoost or LightGBM model</span>
<span class="sd">            - Model must be trained on the same variables in the data</span>
<span class="sd">            - Creates interaction features by multiplying parent  child variables</span>
<span class="sd">            - Interactions are identified where child gain &gt; parent gain</span>
<span class="sd">            - Strong interactions indicate the child variable adds significant</span>
<span class="sd">              information beyond the parent variable</span>

<span class="sd">        Algorithm:</span>
<span class="sd">            1. Extract tree structure from XGBoost/LightGBM model</span>
<span class="sd">            2. For each tree, analyze parent-child node relationships</span>
<span class="sd">            3. Identify strong interactions: child gain &gt; parent gain</span>
<span class="sd">            4. Calculate importance metrics: sumGain, frequency, meanGain</span>
<span class="sd">            5. Select top features/interactions by importance</span>
<span class="sd">            6. Create interaction features: parent  child</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from xgboost import XGBRegressor</span>
<span class="sd">            &gt;&gt;&gt; from py_recipes import recipe</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Fit tree model (REQUIRED)</span>
<span class="sd">            &gt;&gt;&gt; tree_model = XGBRegressor(n_estimators=100, max_depth=3)</span>
<span class="sd">            &gt;&gt;&gt; tree_model.fit(X_train, y_train)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Basic usage - find and create top interactions</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_eix(</span>
<span class="sd">            ...     tree_model=tree_model,</span>
<span class="sd">            ...     outcome=&#39;target&#39;,</span>
<span class="sd">            ...     option=&#39;interactions&#39;,</span>
<span class="sd">            ...     top_n=10</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Conservative - only strong interactions</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_eix(</span>
<span class="sd">            ...     tree_model=tree_model,</span>
<span class="sd">            ...     outcome=&#39;sales&#39;,</span>
<span class="sd">            ...     option=&#39;interactions&#39;,</span>
<span class="sd">            ...     min_gain=0.1,</span>
<span class="sd">            ...     top_n=5</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Select important variables only (no interactions)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_eix(</span>
<span class="sd">            ...     tree_model=tree_model,</span>
<span class="sd">            ...     outcome=&#39;revenue&#39;,</span>
<span class="sd">            ...     option=&#39;variables&#39;,</span>
<span class="sd">            ...     top_n=15,</span>
<span class="sd">            ...     create_interactions=False</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Both variables and interactions</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_eix(</span>
<span class="sd">            ...     tree_model=tree_model,</span>
<span class="sd">            ...     outcome=&#39;target&#39;,</span>
<span class="sd">            ...     option=&#39;both&#39;,</span>
<span class="sd">            ...     top_n=20,</span>
<span class="sd">            ...     min_gain=0.05</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Inspect importance after prep</span>
<span class="sd">            &gt;&gt;&gt; prepped = rec.prep(train_data)</span>
<span class="sd">            &gt;&gt;&gt; eix_step = prepped.prepared_steps[0]</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Get importance table</span>
<span class="sd">            &gt;&gt;&gt; importance = eix_step.get_importance()</span>
<span class="sd">            &gt;&gt;&gt; print(importance)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Get interactions to be created</span>
<span class="sd">            &gt;&gt;&gt; interactions = eix_step.get_interactions()</span>
<span class="sd">            &gt;&gt;&gt; for inter in interactions:</span>
<span class="sd">            ...     print(f&quot;{inter[&#39;parent&#39;]}  {inter[&#39;child&#39;]}  {inter[&#39;name&#39;]}&quot;)</span>

<span class="sd">        Use cases:</span>
<span class="sd">            - Feature selection based on tree model analysis</span>
<span class="sd">            - Identifying important variable interactions</span>
<span class="sd">            - Creating interaction features for linear models</span>
<span class="sd">            - Transfer knowledge from tree models to simpler models</span>
<span class="sd">            - Understanding which variable pairs are most informative</span>

<span class="sd">        Comparison:</span>
<span class="sd">            - vs. step_interact(): EIX uses tree model gain (data-driven),</span>
<span class="sd">              step_interact() creates all pairwise interactions (exhaustive)</span>
<span class="sd">            - vs. step_safe(): EIX uses tree structure directly,</span>
<span class="sd">              SAFE uses partial dependence plots (PDP)</span>
<span class="sd">            - vs. step_poly(): EIX creates multiplicative interactions,</span>
<span class="sd">              step_poly() creates polynomial features</span>

<span class="sd">        Dependencies:</span>
<span class="sd">            Requires: xgboost or lightgbm</span>

<span class="sd">            &gt;&gt;&gt; pip install xgboost lightgbm</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.interaction_detection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepEIX</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepEIX</span><span class="p">(</span>
            <span class="n">tree_model</span><span class="o">=</span><span class="n">tree_model</span><span class="p">,</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">option</span><span class="o">=</span><span class="n">option</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">min_gain</span><span class="o">=</span><span class="n">min_gain</span><span class="p">,</span>
            <span class="n">create_interactions</span><span class="o">=</span><span class="n">create_interactions</span><span class="p">,</span>
            <span class="n">keep_original_cols</span><span class="o">=</span><span class="n">keep_original_cols</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_naomit">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_naomit">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_naomit</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove rows with missing values.</span>

<span class="sd">        Filters out rows containing NA/NaN values in specified columns.</span>
<span class="sd">        Commonly used after creating lag features which introduce NaN at</span>
<span class="sd">        the beginning of time series.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to check for NAs (None = check all columns)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Remove rows with any NA values</span>
<span class="sd">            &gt;&gt;&gt; recipe().step_lag([&#39;value&#39;], lags=[1, 7]).step_naomit()</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Remove rows with NA in specific lag columns</span>
<span class="sd">            &gt;&gt;&gt; recipe().step_naomit(columns=[&#39;value_lag_1&#39;, &#39;value_lag_7&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.naomit</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepNaOmit</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepNaOmit</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">))</span></div>


    <span class="c1"># ========== Extended Categorical Steps ==========</span>

<div class="viewcode-block" id="Recipe.step_other">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_other">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_other</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="n">other_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;other&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pool infrequent categorical levels into &quot;other&quot;.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Categorical columns (None = all categorical)</span>
<span class="sd">            threshold: Minimum frequency to keep level</span>
<span class="sd">            other_label: Label for pooled category</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.categorical_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepOther</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepOther</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">other_label</span><span class="o">=</span><span class="n">other_label</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_novel">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_novel">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_novel</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">novel_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;new&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle novel categorical levels in new data.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Categorical columns (None = all categorical)</span>
<span class="sd">            novel_label: Label for novel levels</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.categorical_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepNovel</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepNovel</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">novel_label</span><span class="o">=</span><span class="n">novel_label</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_unknown">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_unknown">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_unknown</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unknown_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_unknown_&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign missing categorical values to &quot;unknown&quot; level.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Categorical columns (None = all categorical)</span>
<span class="sd">            unknown_label: Label for missing values</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.categorical_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepUnknown</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepUnknown</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">unknown_label</span><span class="o">=</span><span class="n">unknown_label</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_indicate_na">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_indicate_na">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_indicate_na</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;na_ind&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create indicator columns for missing values.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to create indicators for (None = all with NA)</span>
<span class="sd">            prefix: Prefix for indicator columns</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.categorical_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepIndicateNa</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepIndicateNa</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_integer">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_integer">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_integer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">zero_based</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Integer encode categorical variables.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Categorical columns (None = all categorical)</span>
<span class="sd">            zero_based: Use zero-based indexing</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.categorical_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepInteger</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepInteger</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">zero_based</span><span class="o">=</span><span class="n">zero_based</span><span class="p">))</span></div>


    <span class="c1"># ========== Extended Imputation Steps ==========</span>

<div class="viewcode-block" id="Recipe.step_impute_mode">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_impute_mode">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_impute_mode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Impute missing values using mode (most frequent value).</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to impute (None = all with NA)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepImputeMode</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepImputeMode</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_impute_knn">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_impute_knn">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_impute_knn</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">neighbors</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;uniform&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Impute missing values using K-Nearest Neighbors.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to impute (None = all numeric with NA)</span>
<span class="sd">            neighbors: Number of neighbors</span>
<span class="sd">            weights: Weight function (&#39;uniform&#39; or &#39;distance&#39;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepImputeKnn</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepImputeKnn</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">neighbors</span><span class="o">=</span><span class="n">neighbors</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_impute_linear">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_impute_linear">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_impute_linear</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">limit_direction</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Impute missing values using linear interpolation.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to impute (None = all numeric with NA)</span>
<span class="sd">            limit: Maximum consecutive NAs to fill</span>
<span class="sd">            limit_direction: Direction to fill (&#39;forward&#39;, &#39;backward&#39;, &#39;both&#39;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepImputeLinear</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepImputeLinear</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit_direction</span><span class="o">=</span><span class="n">limit_direction</span><span class="p">))</span></div>


    <span class="c1"># ========== Basis Function Steps ==========</span>

<div class="viewcode-block" id="Recipe.step_bs">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_bs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_bs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">degree</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">knots</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create B-spline basis functions.</span>

<span class="sd">        Args:</span>
<span class="sd">            column: Column to create splines for</span>
<span class="sd">            degree: Degree of spline</span>
<span class="sd">            df: Degrees of freedom</span>
<span class="sd">            knots: Number of internal knots</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.basis</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepBs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepBs</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">degree</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">knots</span><span class="o">=</span><span class="n">knots</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_ns">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_ns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_ns</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">knots</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create natural spline basis functions.</span>

<span class="sd">        Args:</span>
<span class="sd">            column: Column to create splines for</span>
<span class="sd">            df: Degrees of freedom</span>
<span class="sd">            knots: Number of internal knots</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.basis</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepNs</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepNs</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">knots</span><span class="o">=</span><span class="n">knots</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_poly">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_poly">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_poly</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">degree</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">include_interactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create polynomial features.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to create polynomials for</span>
<span class="sd">            degree: Maximum polynomial degree</span>
<span class="sd">            include_interactions: Include cross terms</span>
<span class="sd">            inplace: If True, replace original columns; if False, keep originals (default: True)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.basis</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepPoly</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepPoly</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">degree</span><span class="p">,</span> <span class="n">include_interactions</span><span class="o">=</span><span class="n">include_interactions</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_harmonic">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_harmonic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_harmonic</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">frequency</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">period</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create harmonic (Fourier) basis functions.</span>

<span class="sd">        Args:</span>
<span class="sd">            column: Column to create harmonics for</span>
<span class="sd">            frequency: Number of harmonics/cycles</span>
<span class="sd">            period: Period of seasonality</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.basis</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepHarmonic</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepHarmonic</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">))</span></div>


    <span class="c1"># ========== Interaction Steps ==========</span>

<div class="viewcode-block" id="Recipe.step_interact">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_interact">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_interact</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">interactions</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">tuple</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">],</span>
        <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_x_&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create interaction features between columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            interactions: Can be:</span>
<span class="sd">                - List of column pairs: [(&quot;x1&quot;, &quot;x2&quot;), (&quot;x1&quot;, &quot;x3&quot;)]</span>
<span class="sd">                - List of columns: [&quot;x1&quot;, &quot;x2&quot;, &quot;x3&quot;] (creates all pairwise interactions)</span>
<span class="sd">                - Selector function: all_numeric_predictors() (creates all pairwise interactions)</span>
<span class="sd">            separator: Separator for interaction names (default: &quot;_x_&quot;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Specific pairs</span>
<span class="sd">            &gt;&gt;&gt; rec.step_interact([(&quot;x1&quot;, &quot;x2&quot;), (&quot;x1&quot;, &quot;x3&quot;)])</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # All pairs from list</span>
<span class="sd">            &gt;&gt;&gt; rec.step_interact([&quot;x1&quot;, &quot;x2&quot;, &quot;x3&quot;])</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # All pairs from selector</span>
<span class="sd">            &gt;&gt;&gt; rec.step_interact(all_numeric_predictors())</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.interactions</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepInteract</span>

        <span class="c1"># Pass directly to StepInteract - it will handle resolution during prep()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepInteract</span><span class="p">(</span><span class="n">interactions</span><span class="o">=</span><span class="n">interactions</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_ratio">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_ratio">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_ratio</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ratios</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">tuple</span><span class="p">],</span>
        <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span>
        <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_per_&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create ratio features between columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            ratios: List of (numerator, denominator) pairs</span>
<span class="sd">            offset: Small value to avoid division by zero</span>
<span class="sd">            separator: Separator for ratio names</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.interactions</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepRatio</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepRatio</span><span class="p">(</span><span class="n">ratios</span><span class="o">=</span><span class="n">ratios</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">))</span></div>


    <span class="c1"># ========== Discretization Steps ==========</span>

<div class="viewcode-block" id="Recipe.step_discretize">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_discretize">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_discretize</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_breaks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;quantile&quot;</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Discretize numeric columns into bins.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to discretize (None = all numeric)</span>
<span class="sd">            num_breaks: Number of bins</span>
<span class="sd">            method: Binning method (&#39;quantile&#39; or &#39;width&#39;)</span>
<span class="sd">            labels: Custom bin labels</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.discretization</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepDiscretize</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepDiscretize</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">num_breaks</span><span class="o">=</span><span class="n">num_breaks</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_cut">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_cut">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_cut</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">breaks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">include_lowest</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cut numeric columns at specified thresholds.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to cut</span>
<span class="sd">            breaks: Dict of column -&gt; list of breakpoints</span>
<span class="sd">            labels: Dict of column -&gt; list of labels</span>
<span class="sd">            include_lowest: Include lowest value in first bin</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.discretization</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepCut</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepCut</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">breaks</span><span class="o">=</span><span class="n">breaks</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">include_lowest</span><span class="o">=</span><span class="n">include_lowest</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_percentile">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_percentile">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_percentile</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_breaks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">as_integer</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert numeric columns to percentile ranks.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to convert (None = all numeric)</span>
<span class="sd">            num_breaks: Number of percentile bins (default: 100 for 0-100 scale)</span>
<span class="sd">            as_integer: Return integer percentiles (default: True)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.discretization</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepPercentile</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepPercentile</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">num_breaks</span><span class="o">=</span><span class="n">num_breaks</span><span class="p">,</span> <span class="n">as_integer</span><span class="o">=</span><span class="n">as_integer</span><span class="p">))</span></div>


    <span class="c1"># ========== Advanced Dimensionality Reduction Steps ==========</span>

<div class="viewcode-block" id="Recipe.step_ica">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_ica">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_ica</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_comp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parallel&quot;</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Independent Component Analysis transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to apply ICA to (None = all numeric)</span>
<span class="sd">            num_comp: Number of components</span>
<span class="sd">            algorithm: ICA algorithm (&#39;parallel&#39;, &#39;deflation&#39;)</span>
<span class="sd">            max_iter: Maximum iterations</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.reduction</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepIca</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepIca</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">num_comp</span><span class="o">=</span><span class="n">num_comp</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">algorithm</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_kpca">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_kpca">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_kpca</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_comp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">kernel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;rbf&quot;</span><span class="p">,</span>
        <span class="n">gamma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Kernel Principal Component Analysis.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to apply kernel PCA to (None = all numeric)</span>
<span class="sd">            num_comp: Number of components</span>
<span class="sd">            kernel: Kernel type (&#39;linear&#39;, &#39;poly&#39;, &#39;rbf&#39;, &#39;sigmoid&#39;)</span>
<span class="sd">            gamma: Kernel coefficient</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.reduction</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepKpca</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepKpca</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">num_comp</span><span class="o">=</span><span class="n">num_comp</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_pls">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_pls">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_pls</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_comp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Partial Least Squares transformation.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Predictor columns (None = all numeric except outcome)</span>
<span class="sd">            outcome: Outcome column name</span>
<span class="sd">            num_comp: Number of components</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.reduction</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepPls</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepPls</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span> <span class="n">num_comp</span><span class="o">=</span><span class="n">num_comp</span><span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_holiday">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_holiday">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_holiday</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">date_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">country</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;US&quot;</span><span class="p">,</span>
        <span class="n">holidays</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;holiday_&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add holiday indicator features.</span>

<span class="sd">        Creates binary indicators for holidays, useful for capturing</span>
<span class="sd">        holiday effects in time series models. Uses pytimetk if available.</span>

<span class="sd">        Args:</span>
<span class="sd">            date_column: Column containing dates</span>
<span class="sd">            country: Country code for holidays (e.g., &#39;US&#39;, &#39;UK&#39;, &#39;CA&#39;)</span>
<span class="sd">            holidays: List of specific holidays (None = all major holidays)</span>
<span class="sd">            prefix: Prefix for created columns</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_holiday(&#39;date&#39;, country=&#39;US&#39;)</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_holiday(&#39;date&#39;, holidays=[&quot;Christmas Day&quot;, &quot;New Year&#39;s Day&quot;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepHoliday</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepHoliday</span><span class="p">(</span>
            <span class="n">date_column</span><span class="o">=</span><span class="n">date_column</span><span class="p">,</span>
            <span class="n">country</span><span class="o">=</span><span class="n">country</span><span class="p">,</span>
            <span class="n">holidays</span><span class="o">=</span><span class="n">holidays</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_fourier">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_fourier">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_fourier</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">date_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">period</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">K</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fourier_&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add Fourier features for seasonality.</span>

<span class="sd">        Creates sine and cosine features at different frequencies to capture</span>
<span class="sd">        seasonal patterns. Works with pytimetk if available.</span>

<span class="sd">        Args:</span>
<span class="sd">            date_column: Column containing dates or numeric time index</span>
<span class="sd">            period: Period of seasonality (e.g., 365 for yearly, 12 for monthly)</span>
<span class="sd">            K: Number of Fourier term pairs to include</span>
<span class="sd">            prefix: Prefix for created columns</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Yearly seasonality with 5 Fourier pairs</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_fourier(&#39;date&#39;, period=365, K=5)</span>
<span class="sd">            &gt;&gt;&gt; # Monthly seasonality</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_fourier(&#39;month&#39;, period=12, K=3)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepFourier</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepFourier</span><span class="p">(</span>
            <span class="n">date_column</span><span class="o">=</span><span class="n">date_column</span><span class="p">,</span>
            <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span>
            <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_timeseries_signature">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_timeseries_signature">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_timeseries_signature</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">date_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract comprehensive time-based features from dates.</span>

<span class="sd">        Creates 15+ time features including hour, day, month, quarter, year,</span>
<span class="sd">        day of week, weekend indicators, etc. Uses pytimetk if available.</span>

<span class="sd">        Args:</span>
<span class="sd">            date_column: Column containing dates</span>
<span class="sd">            features: List of specific features to extract (None = all)</span>
<span class="sd">            prefix: Prefix for created columns</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Extract all time features</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_timeseries_signature(&#39;date&#39;)</span>
<span class="sd">            &gt;&gt;&gt; # Extract specific features</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_timeseries_signature(&#39;date&#39;, features=[&#39;month&#39;, &#39;day_of_week&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepTimeseriesSignature</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepTimeseriesSignature</span><span class="p">(</span>
            <span class="n">date_column</span><span class="o">=</span><span class="n">date_column</span><span class="p">,</span>
            <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_lead">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_lead">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_lead</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">leads</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;lead_&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create lead (future) features.</span>

<span class="sd">        Creates features that look ahead in time, useful for prediction tasks.</span>
<span class="sd">        Works with pytimetk if available.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to create leads for</span>
<span class="sd">            leads: List of lead periods (e.g., [1, 2, 7])</span>
<span class="sd">            prefix: Prefix for created columns</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # 1-step and 7-step ahead features</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_lead([&#39;sales&#39;, &#39;price&#39;], leads=[1, 7])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepLead</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepLead</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">leads</span><span class="o">=</span><span class="n">leads</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_ewm">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_ewm">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_ewm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">span</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">statistics</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ewm_&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create exponentially weighted moving (EWM) features.</span>

<span class="sd">        Computes EWM statistics giving more weight to recent observations.</span>
<span class="sd">        Useful for capturing trends and momentum.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to compute EWM for</span>
<span class="sd">            span: Span for exponential weighting (smaller = more recent weight)</span>
<span class="sd">            statistics: Statistics to compute (&#39;mean&#39;, &#39;std&#39;, &#39;var&#39;)</span>
<span class="sd">            prefix: Prefix for created columns</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # EWM mean with span of 10</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_ewm([&#39;sales&#39;], span=10, statistics=[&#39;mean&#39;])</span>
<span class="sd">            &gt;&gt;&gt; # EWM mean and std</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_ewm([&#39;price&#39;], span=20, statistics=[&#39;mean&#39;, &#39;std&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepEwm</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepEwm</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">span</span><span class="o">=</span><span class="n">span</span><span class="p">,</span>
            <span class="n">statistics</span><span class="o">=</span><span class="n">statistics</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_expanding">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_expanding">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_expanding</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">statistics</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;expanding_&quot;</span><span class="p">,</span>
        <span class="n">min_periods</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create expanding window features.</span>

<span class="sd">        Computes cumulative statistics from the start to each point.</span>
<span class="sd">        Useful for running totals, cumulative averages, etc.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to compute expanding stats for</span>
<span class="sd">            statistics: Statistics to compute (&#39;mean&#39;, &#39;std&#39;, &#39;sum&#39;, &#39;min&#39;, &#39;max&#39;)</span>
<span class="sd">            prefix: Prefix for created columns</span>
<span class="sd">            min_periods: Minimum periods required</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Cumulative mean</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_expanding([&#39;sales&#39;], statistics=[&#39;mean&#39;])</span>
<span class="sd">            &gt;&gt;&gt; # Running total and cumulative average</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_expanding([&#39;revenue&#39;], statistics=[&#39;sum&#39;, &#39;mean&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_extended</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepExpanding</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepExpanding</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">statistics</span><span class="o">=</span><span class="n">statistics</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
            <span class="n">min_periods</span><span class="o">=</span><span class="n">min_periods</span>
        <span class="p">))</span></div>


    <span class="c1"># Role Management Methods</span>

<div class="viewcode-block" id="Recipe.update_role">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.update_role">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_role</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">new_role</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">old_role</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the role of specified columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Column names to update</span>
<span class="sd">            new_role: New role to assign</span>
<span class="sd">            old_role: Optional old role to remove from (if None, removes from all roles)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe()</span>
<span class="sd">            &gt;&gt;&gt; rec = rec.update_role([&#39;id&#39;], &#39;ID&#39;)</span>
<span class="sd">            &gt;&gt;&gt; rec = rec.update_role([&#39;outcome&#39;], &#39;outcome&#39;)</span>
<span class="sd">            &gt;&gt;&gt; rec = rec.update_role([&#39;x1&#39;, &#39;x2&#39;], &#39;predictor&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Remove from old role if specified</span>
        <span class="k">if</span> <span class="n">old_role</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">old_role</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">old_role</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">old_role</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns</span>
                <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Remove from all roles</span>
            <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">role</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">role</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns</span>
                <span class="p">]</span>

        <span class="c1"># Add to new role</span>
        <span class="k">if</span> <span class="n">new_role</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">new_role</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Add columns that aren&#39;t already in the new role</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">new_role</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">new_role</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="Recipe.add_role">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.add_role">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_role</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">new_role</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a role to specified columns (doesn&#39;t remove existing roles).</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Column names to add role to</span>
<span class="sd">            new_role: Role to add</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe()</span>
<span class="sd">            &gt;&gt;&gt; rec = rec.add_role([&#39;id&#39;], &#39;ID&#39;)</span>
<span class="sd">            &gt;&gt;&gt; rec = rec.add_role([&#39;timestamp&#39;], &#39;time_index&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_role</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">new_role</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Add columns that aren&#39;t already in the role</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">new_role</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">new_role</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="Recipe.remove_role">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.remove_role">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_role</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">old_role</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove a role from specified columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Column names to remove role from</span>
<span class="sd">            old_role: Role to remove</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe()</span>
<span class="sd">            &gt;&gt;&gt; rec = rec.remove_role([&#39;x1&#39;], &#39;predictor&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">old_role</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">old_role</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="p">[</span><span class="n">old_role</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns</span>
            <span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="Recipe.has_role">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.has_role">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">has_role</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">role</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;predictor&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get columns with a specific role.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Optional subset of columns to filter (None = all columns)</span>
<span class="sd">            role: Role to filter by</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of column names with the specified role</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe()</span>
<span class="sd">            &gt;&gt;&gt; rec = rec.update_role([&#39;x1&#39;, &#39;x2&#39;], &#39;predictor&#39;)</span>
<span class="sd">            &gt;&gt;&gt; rec.has_role(role=&#39;predictor&#39;)</span>
<span class="sd">            [&#39;x1&#39;, &#39;x2&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">role_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">roles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">role_cols</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">role_cols</span><span class="p">]</span></div>


    <span class="c1"># Advanced Feature Selection Methods</span>

<div class="viewcode-block" id="Recipe.step_vip">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_vip">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_vip</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">num_comp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Variable Importance in Projection (VIP) feature selection.</span>

<span class="sd">        Calculates VIP scores from a PLS model and selects features based on threshold.</span>
<span class="sd">        VIP scores measure the importance of each variable in the projection used in a PLS model.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome column (required for supervised selection)</span>
<span class="sd">            threshold: VIP threshold for feature selection (default 1.0)</span>
<span class="sd">                Variables with VIP &gt; threshold are kept</span>
<span class="sd">            num_comp: Number of PLS components to use (default 2)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe()</span>
<span class="sd">            &gt;&gt;&gt; rec = rec.step_vip(outcome=&#39;y&#39;, threshold=1.0, num_comp=2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_selection_advanced</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepVip</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepVip</span><span class="p">(</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">num_comp</span><span class="o">=</span><span class="n">num_comp</span><span class="p">,</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_boruta">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_boruta">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_boruta</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">perc</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Boruta all-relevant feature selection.</span>

<span class="sd">        Uses Boruta algorithm to identify all features that are statistically relevant</span>
<span class="sd">        to the outcome. Creates shadow features and compares real feature importance</span>
<span class="sd">        to maximum shadow importance.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome column (required)</span>
<span class="sd">            max_iter: Maximum number of iterations (default 100)</span>
<span class="sd">            random_state: Random seed for reproducibility (default None)</span>
<span class="sd">            perc: Percentile of shadow feature importance to compare against (default 100)</span>
<span class="sd">            alpha: P-value threshold for feature importance test (default 0.05)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe()</span>
<span class="sd">            &gt;&gt;&gt; rec = rec.step_boruta(outcome=&#39;y&#39;, max_iter=100)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_selection_advanced</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepBoruta</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepBoruta</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
            <span class="n">perc</span><span class="o">=</span><span class="n">perc</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_rfe">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_rfe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_rfe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">n_features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">estimator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursive Feature Elimination (RFE) feature selection.</span>

<span class="sd">        Recursively removes features and builds models to find the optimal subset.</span>
<span class="sd">        Uses model coefficients or feature importances to rank features.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome column (required)</span>
<span class="sd">            n_features: Number of features to select (default None = select half)</span>
<span class="sd">            step: Number of features to remove at each iteration (default 1)</span>
<span class="sd">            estimator: Sklearn estimator to use (default None = LogisticRegression/LinearRegression)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe()</span>
<span class="sd">            &gt;&gt;&gt; rec = rec.step_rfe(outcome=&#39;y&#39;, n_features=10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_selection_advanced</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepRfe</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepRfe</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">n_features</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span>
            <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span>
            <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_dt_discretiser">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_dt_discretiser">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_dt_discretiser</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cv</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">scoring</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">,</span>
        <span class="n">regression</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Discretize continuous variables using decision trees.</span>

<span class="sd">        Uses feature-engine&#39;s DecisionTreeDiscretiser to bin numeric variables</span>
<span class="sd">        based on decision tree splits optimized for predicting the outcome.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome column</span>
<span class="sd">            columns: Column selector (None = all numeric except outcome)</span>
<span class="sd">            cv: Cross-validation folds</span>
<span class="sd">            scoring: Scoring metric</span>
<span class="sd">            regression: True for regression tree, False for classification</span>
<span class="sd">            random_state: Random state for reproducibility</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_dt_discretiser(outcome=&#39;target&#39;, cv=5)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_engine_steps</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepDtDiscretiser</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepDtDiscretiser</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
            <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span>
            <span class="n">regression</span><span class="o">=</span><span class="n">regression</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_winsorizer">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_winsorizer">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_winsorizer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">capping_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;iqr&#39;</span><span class="p">,</span>
        <span class="n">tail</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">fold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span>
        <span class="n">quantiles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cap extreme values using Winsorization.</span>

<span class="sd">        Uses feature-engine&#39;s Winsorizer to replace extreme values with less</span>
<span class="sd">        extreme values at specified percentiles.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Column selector (None = all numeric)</span>
<span class="sd">            capping_method: &#39;iqr&#39;, &#39;gaussian&#39;, or &#39;quantiles&#39;</span>
<span class="sd">            tail: &#39;right&#39;, &#39;left&#39;, or &#39;both&#39;</span>
<span class="sd">            fold: Multiplier for IQR or number of std deviations</span>
<span class="sd">            quantiles: For &#39;quantiles&#39; method: (lower, upper)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_winsorizer(</span>
<span class="sd">            ...     columns=[&#39;income&#39;, &#39;age&#39;], capping_method=&#39;iqr&#39;, fold=1.5</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_engine_steps</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepWinsorizer</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepWinsorizer</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">capping_method</span><span class="o">=</span><span class="n">capping_method</span><span class="p">,</span>
            <span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span>
            <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">,</span>
            <span class="n">quantiles</span><span class="o">=</span><span class="n">quantiles</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_outlier_trimmer">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_outlier_trimmer">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_outlier_trimmer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">capping_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;iqr&#39;</span><span class="p">,</span>
        <span class="n">tail</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">fold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span>
        <span class="n">quantiles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove observations with outliers.</span>

<span class="sd">        Uses feature-engine&#39;s OutlierTrimmer to remove rows containing outliers</span>
<span class="sd">        in specified columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Column selector (None = all numeric)</span>
<span class="sd">            capping_method: &#39;iqr&#39;, &#39;gaussian&#39;, or &#39;quantiles&#39;</span>
<span class="sd">            tail: &#39;right&#39;, &#39;left&#39;, or &#39;both&#39;</span>
<span class="sd">            fold: Multiplier for IQR or number of std deviations</span>
<span class="sd">            quantiles: For &#39;quantiles&#39; method: (lower, upper)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_outlier_trimmer(</span>
<span class="sd">            ...     columns=[&#39;score&#39;], capping_method=&#39;gaussian&#39;, tail=&#39;right&#39;, fold=3.0</span>
<span class="sd">            ... )</span>

<span class="sd">        Warnings:</span>
<span class="sd">            This step removes rows, which can cause index misalignment.</span>
<span class="sd">            Use early in recipe pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_engine_steps</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepOutlierTrimmer</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepOutlierTrimmer</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">capping_method</span><span class="o">=</span><span class="n">capping_method</span><span class="p">,</span>
            <span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span>
            <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">,</span>
            <span class="n">quantiles</span><span class="o">=</span><span class="n">quantiles</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_dt_features">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_dt_features">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_dt_features</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">features_to_combine</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cv</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">scoring</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">,</span>
        <span class="n">regression</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create new features using decision trees.</span>

<span class="sd">        Uses feature-engine&#39;s DecisionTreeFeatures to create engineered features</span>
<span class="sd">        by combining existing features through decision tree models.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome column</span>
<span class="sd">            columns: Column selector (None = all numeric except outcome)</span>
<span class="sd">            features_to_combine: Number of features to combine (None = all combinations)</span>
<span class="sd">            cv: Cross-validation folds</span>
<span class="sd">            scoring: Scoring metric</span>
<span class="sd">            regression: True for regression tree, False for classification</span>
<span class="sd">            random_state: Random state for reproducibility</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_dt_features(</span>
<span class="sd">            ...     outcome=&#39;price&#39;, features_to_combine=5, cv=5</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_engine_steps</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepDtFeatures</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepDtFeatures</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">features_to_combine</span><span class="o">=</span><span class="n">features_to_combine</span><span class="p">,</span>
            <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
            <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span>
            <span class="n">regression</span><span class="o">=</span><span class="n">regression</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_smart_corr">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_smart_corr">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_smart_corr</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pearson&#39;</span><span class="p">,</span>
        <span class="n">selection_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;variance&#39;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features using smart correlation selection.</span>

<span class="sd">        Uses feature-engine&#39;s SmartCorrelatedSelection to remove correlated features</span>
<span class="sd">        intelligently by keeping the one most correlated with the outcome.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome column</span>
<span class="sd">            columns: Column selector (None = all numeric except outcome)</span>
<span class="sd">            threshold: Correlation threshold (0-1)</span>
<span class="sd">            method: &#39;pearson&#39;, &#39;spearman&#39;, or &#39;kendall&#39;</span>
<span class="sd">            selection_method: &#39;variance&#39;, &#39;cardinality&#39;, or &#39;model_performance&#39;</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_smart_corr(</span>
<span class="sd">            ...     outcome=&#39;target&#39;, threshold=0.9, selection_method=&#39;model_performance&#39;</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_engine_steps</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectSmartCorr</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectSmartCorr</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">selection_method</span><span class="o">=</span><span class="n">selection_method</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_psi">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_psi">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_psi</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span>
        <span class="n">bins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;equal_frequency&#39;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove features with high Population Stability Index (PSI).</span>

<span class="sd">        Uses feature-engine&#39;s DropHighPSIFeatures to identify and remove features</span>
<span class="sd">        with high PSI, indicating distribution shifts between training and test data.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Column selector (None = all numeric)</span>
<span class="sd">            threshold: PSI threshold (&gt;0.25 = significant change)</span>
<span class="sd">            bins: Number of bins for discretization</span>
<span class="sd">            strategy: &#39;equal_frequency&#39; or &#39;equal_width&#39;</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_psi(threshold=0.25, bins=10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.feature_engine_steps</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectPsi</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectPsi</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
            <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_clean_anomalies">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_clean_anomalies">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_clean_anomalies</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">date_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">value_columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">trend</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;stl&#39;</span><span class="p">,</span>
        <span class="n">decomp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;additive&#39;</span><span class="p">,</span>
        <span class="n">clean</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;min_max&#39;</span><span class="p">,</span>
        <span class="n">iqr_alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="n">clean_alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span>
        <span class="n">max_anomalies</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect and clean anomalies in time series data.</span>

<span class="sd">        Uses pytimetk&#39;s anomalize to detect and clean anomalies via STL decomposition</span>
<span class="sd">        or Twitter&#39;s AnomalyDetection algorithm.</span>

<span class="sd">        Args:</span>
<span class="sd">            date_column: Name of date/time column</span>
<span class="sd">            value_columns: Columns to check (None = all numeric)</span>
<span class="sd">            period: Seasonal period (auto-detected if None)</span>
<span class="sd">            trend: Trend window for STL (auto-detected if None)</span>
<span class="sd">            method: &#39;stl&#39; or &#39;twitter&#39;</span>
<span class="sd">            decomp: &#39;additive&#39; or &#39;multiplicative&#39;</span>
<span class="sd">            clean: &#39;min_max&#39; or &#39;linear&#39;</span>
<span class="sd">            iqr_alpha: Alpha for IQR detection (lower = more sensitive)</span>
<span class="sd">            clean_alpha: Cleaning strength 0-1 (higher = more aggressive)</span>
<span class="sd">            max_anomalies: Max proportion of anomalies 0-1</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_clean_anomalies(</span>
<span class="sd">            ...     date_column=&#39;date&#39;,</span>
<span class="sd">            ...     value_columns=[&#39;sales&#39;],</span>
<span class="sd">            ...     method=&#39;stl&#39;</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepCleanAnomalies</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepCleanAnomalies</span><span class="p">(</span>
            <span class="n">date_column</span><span class="o">=</span><span class="n">date_column</span><span class="p">,</span>
            <span class="n">value_columns</span><span class="o">=</span><span class="n">value_columns</span><span class="p">,</span>
            <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span>
            <span class="n">trend</span><span class="o">=</span><span class="n">trend</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">decomp</span><span class="o">=</span><span class="n">decomp</span><span class="p">,</span>
            <span class="n">clean</span><span class="o">=</span><span class="n">clean</span><span class="p">,</span>
            <span class="n">iqr_alpha</span><span class="o">=</span><span class="n">iqr_alpha</span><span class="p">,</span>
            <span class="n">clean_alpha</span><span class="o">=</span><span class="n">clean_alpha</span><span class="p">,</span>
            <span class="n">max_anomalies</span><span class="o">=</span><span class="n">max_anomalies</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_stationary">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_stationary">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_stationary</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_diff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;adf&#39;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="n">seasonal_diff</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">seasonal_period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transform time series to make it stationary.</span>

<span class="sd">        Applies differencing verified by ADF/KPSS test until stationary.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to transform (None = all numeric)</span>
<span class="sd">            max_diff: Maximum differencing order (1 or 2)</span>
<span class="sd">            test: &#39;adf&#39;, &#39;kpss&#39;, or &#39;both&#39;</span>
<span class="sd">            alpha: Significance level for test</span>
<span class="sd">            seasonal_diff: Apply seasonal differencing first</span>
<span class="sd">            seasonal_period: Seasonal period (required if seasonal_diff=True)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_stationary(</span>
<span class="sd">            ...     columns=[&#39;sales&#39;],</span>
<span class="sd">            ...     max_diff=2,</span>
<span class="sd">            ...     test=&#39;adf&#39;</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepStationary</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepStationary</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">max_diff</span><span class="o">=</span><span class="n">max_diff</span><span class="p">,</span>
            <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">seasonal_diff</span><span class="o">=</span><span class="n">seasonal_diff</span><span class="p">,</span>
            <span class="n">seasonal_period</span><span class="o">=</span><span class="n">seasonal_period</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_deseasonalize">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_deseasonalize">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_deseasonalize</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;additive&#39;</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;stl&#39;</span><span class="p">,</span>
        <span class="n">extrapolate_trend</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove seasonal component from time series.</span>

<span class="sd">        Uses STL or classical decomposition to extract and remove seasonality.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to deseasonalize (None = all numeric)</span>
<span class="sd">            period: Seasonal period (auto-detected if None)</span>
<span class="sd">            model: &#39;additive&#39; or &#39;multiplicative&#39;</span>
<span class="sd">            method: &#39;stl&#39; or &#39;classical&#39;</span>
<span class="sd">            extrapolate_trend: Points to extrapolate at boundaries</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_deseasonalize(</span>
<span class="sd">            ...     columns=[&#39;sales&#39;],</span>
<span class="sd">            ...     period=12,</span>
<span class="sd">            ...     model=&#39;additive&#39;</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepDeseasonalize</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepDeseasonalize</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">extrapolate_trend</span><span class="o">=</span><span class="n">extrapolate_trend</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_detrend">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_detrend">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_detrend</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
        <span class="n">breakpoints</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove trend from time series.</span>

<span class="sd">        Fits and subtracts linear or constant trend.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to detrend (None = all numeric)</span>
<span class="sd">            method: &#39;linear&#39; or &#39;constant&#39;</span>
<span class="sd">            breakpoints: 0 for single line, int for number of breaks, list for positions</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_detrend(</span>
<span class="sd">            ...     columns=[&#39;sales&#39;],</span>
<span class="sd">            ...     method=&#39;linear&#39;</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepDetrend</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepDetrend</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">breakpoints</span><span class="o">=</span><span class="n">breakpoints</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_h_stat">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_h_stat">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_h_stat</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_estimators</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect interactions using Friedman&#39;s H-statistic.</span>

<span class="sd">        Uses gradient boosting to identify pairwise feature interactions.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            columns: Columns to check (None = all numeric except outcome)</span>
<span class="sd">            top_n: Number of top interactions to keep</span>
<span class="sd">            threshold: H-statistic threshold (alternative to top_n)</span>
<span class="sd">            n_estimators: Number of gradient boosting trees</span>
<span class="sd">            max_depth: Maximum tree depth</span>
<span class="sd">            random_state: Random state for reproducibility</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_h_stat(</span>
<span class="sd">            ...     outcome=&#39;target&#39;,</span>
<span class="sd">            ...     top_n=10</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepHStat</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepHStat</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
            <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_best_lag">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_best_lag">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_best_lag</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_lag</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
        <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ssr_ftest&#39;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="n">add_const</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select optimal lags using Granger causality test.</span>

<span class="sd">        Tests multiple lags and creates features for significant ones.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            columns: Columns to create lags for (None = all numeric except outcome)</span>
<span class="sd">            max_lag: Maximum lag to test</span>
<span class="sd">            test: Granger test type (&#39;ssr_ftest&#39;, &#39;ssr_chi2test&#39;, &#39;lrtest&#39;, &#39;params_ftest&#39;)</span>
<span class="sd">            alpha: Significance level</span>
<span class="sd">            add_const: Add constant to regression</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self for method chaining</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_best_lag(</span>
<span class="sd">            ...     outcome=&#39;sales&#39;,</span>
<span class="sd">            ...     max_lag=12,</span>
<span class="sd">            ...     alpha=0.05</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.timeseries_transformations</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepBestLag</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepBestLag</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">max_lag</span><span class="o">=</span><span class="n">max_lag</span><span class="p">,</span>
            <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">add_const</span><span class="o">=</span><span class="n">add_const</span>
        <span class="p">))</span></div>


    <span class="c1"># Phase 3: Advanced Selection Steps</span>

<div class="viewcode-block" id="Recipe.step_vif">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_vif">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_vif</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove features with high Variance Inflation Factor (VIF).</span>

<span class="sd">        VIF measures multicollinearity by quantifying how much the variance of a</span>
<span class="sd">        coefficient is inflated due to collinearity with other features. Features</span>
<span class="sd">        with VIF &gt; threshold are iteratively removed.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshold: VIF threshold (default 10.0). Common: VIF &lt; 5 (stringent), VIF &lt; 10 (moderate)</span>
<span class="sd">            columns: Which columns to check for VIF</span>
<span class="sd">            outcome: Name of outcome variable (excluded from VIF calculation)</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_vif(threshold=10.0, outcome=&#39;target&#39;)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_vif(threshold=5.0)  # Stricter threshold</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.advanced_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepVif</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepVif</span><span class="p">(</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_pvalue">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_pvalue">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_pvalue</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="n">model_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;logistic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features based on p-values from statistical models.</span>

<span class="sd">        Fits a linear or logistic regression model and selects features with</span>
<span class="sd">        p-values below the threshold.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            threshold: P-value threshold (default 0.05)</span>
<span class="sd">            model_type: &#39;auto&#39;, &#39;linear&#39;, or &#39;logistic&#39;</span>
<span class="sd">            columns: Which columns to test</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_pvalue(outcome=&#39;target&#39;, threshold=0.05)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_pvalue(outcome=&#39;species&#39;, model_type=&#39;logistic&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.advanced_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepPvalue</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepPvalue</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">model_type</span><span class="o">=</span><span class="n">model_type</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_stability">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_stability">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_stability</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="n">n_bootstrap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">sample_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">estimator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_features_per_bootstrap</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stability selection for robust feature selection.</span>

<span class="sd">        Performs feature selection on multiple bootstrap samples and selects</span>
<span class="sd">        features that appear frequently across samples.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            threshold: Selection frequency threshold (0-1, default 0.8)</span>
<span class="sd">            n_bootstrap: Number of bootstrap samples (default 100)</span>
<span class="sd">            sample_fraction: Fraction of data per bootstrap (default 0.5)</span>
<span class="sd">            estimator: Sklearn estimator (default RandomForest)</span>
<span class="sd">            n_features_per_bootstrap: Features to select per bootstrap</span>
<span class="sd">            columns: Which columns to test</span>
<span class="sd">            random_state: Random seed</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_stability(</span>
<span class="sd">            ...     outcome=&#39;target&#39;, threshold=0.8, n_bootstrap=100</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.advanced_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectStability</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectStability</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">n_bootstrap</span><span class="o">=</span><span class="n">n_bootstrap</span><span class="p">,</span>
            <span class="n">sample_fraction</span><span class="o">=</span><span class="n">sample_fraction</span><span class="p">,</span>
            <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
            <span class="n">n_features_per_bootstrap</span><span class="o">=</span><span class="n">n_features_per_bootstrap</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_lofo">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_lofo">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_lofo</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">estimator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cv</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">scoring</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Leave-One-Feature-Out (LOFO) importance for feature selection.</span>

<span class="sd">        Measures each feature&#39;s importance by comparing model performance with</span>
<span class="sd">        and without that feature.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            threshold: Minimum importance to keep feature</span>
<span class="sd">            top_n: Keep top N features by importance</span>
<span class="sd">            top_p: Keep top proportion of features</span>
<span class="sd">            estimator: Sklearn estimator (default RandomForest)</span>
<span class="sd">            cv: Number of CV folds (default 3)</span>
<span class="sd">            scoring: Scoring metric</span>
<span class="sd">            columns: Which columns to test</span>
<span class="sd">            random_state: Random seed</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_lofo(outcome=&#39;target&#39;, top_n=10)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_lofo(outcome=&#39;target&#39;, threshold=0.01, cv=5)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.advanced_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectLofo</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectLofo</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span>
            <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
            <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
            <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_granger">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_granger">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_granger</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">max_lag</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ssr_ftest&#39;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features using Granger causality test.</span>

<span class="sd">        Tests if past values of each feature help predict the outcome.</span>
<span class="sd">        Features that Granger-cause the outcome are selected.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            max_lag: Maximum number of lags to test (default 5)</span>
<span class="sd">            test: Test type (&#39;ssr_ftest&#39;, &#39;ssr_chi2test&#39;, &#39;lrtest&#39;, &#39;params_ftest&#39;)</span>
<span class="sd">            alpha: Significance level (default 0.05)</span>
<span class="sd">            columns: Which columns to test</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_granger(</span>
<span class="sd">            ...     outcome=&#39;sales&#39;, max_lag=5, alpha=0.05</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.advanced_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectGranger</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectGranger</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">max_lag</span><span class="o">=</span><span class="n">max_lag</span><span class="p">,</span>
            <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_stepwise">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_stepwise">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_stepwise</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">direction</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="s1">&#39;backward&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">criterion</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">,</span> <span class="s1">&#39;bic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;aic&#39;</span><span class="p">,</span>
        <span class="n">max_steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">model_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;logistic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stepwise feature selection based on AIC/BIC.</span>

<span class="sd">        Performs forward, backward, or bidirectional stepwise selection by</span>
<span class="sd">        iteratively adding/removing features based on information criteria.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            direction: &#39;forward&#39;, &#39;backward&#39;, or &#39;both&#39; (default &#39;both&#39;)</span>
<span class="sd">            criterion: &#39;aic&#39; or &#39;bic&#39; (default &#39;aic&#39;)</span>
<span class="sd">            max_steps: Maximum number of steps</span>
<span class="sd">            model_type: &#39;auto&#39;, &#39;linear&#39;, or &#39;logistic&#39;</span>
<span class="sd">            columns: Which columns to consider</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_stepwise(</span>
<span class="sd">            ...     outcome=&#39;target&#39;, direction=&#39;forward&#39;, criterion=&#39;aic&#39;</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.advanced_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectStepwise</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectStepwise</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span>
            <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
            <span class="n">max_steps</span><span class="o">=</span><span class="n">max_steps</span><span class="p">,</span>
            <span class="n">model_type</span><span class="o">=</span><span class="n">model_type</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_probe">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_probe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_probe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">n_probes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">estimator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold_percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">random_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Probe feature selection using random features.</span>

<span class="sd">        Creates random &quot;probe&quot; features and compares real feature importances to</span>
<span class="sd">        probe importances. Selects only real features with importance greater than</span>
<span class="sd">        the maximum probe importance.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            n_probes: Number of random probe features (default 10)</span>
<span class="sd">            estimator: Sklearn estimator (default RandomForest)</span>
<span class="sd">            threshold_percentile: Percentile of probe importances (0-100, default 100)</span>
<span class="sd">            columns: Which columns to test</span>
<span class="sd">            random_state: Random seed</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_probe(outcome=&#39;target&#39;, n_probes=10)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_probe(</span>
<span class="sd">            ...     outcome=&#39;target&#39;, n_probes=20, threshold_percentile=95</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.advanced_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectProbe</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectProbe</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">n_probes</span><span class="o">=</span><span class="n">n_probes</span><span class="p">,</span>
            <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
            <span class="n">threshold_percentile</span><span class="o">=</span><span class="n">threshold_percentile</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


    <span class="c1"># ============================================================</span>
    <span class="c1"># Phase 4: Practical Selection Steps</span>
    <span class="c1"># ============================================================</span>

<div class="viewcode-block" id="Recipe.step_select_lasso">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_lasso">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_lasso</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features using Lasso (L1 regularization) regression.</span>

<span class="sd">        Lasso shrinks coefficients toward zero, performing automatic feature</span>
<span class="sd">        selection. Features with non-zero coefficients are kept.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            alpha: Regularization strength (default 1.0)</span>
<span class="sd">            threshold: Keep features with |coefficient| &gt;= threshold</span>
<span class="sd">            top_n: Keep top N features by |coefficient|</span>
<span class="sd">            normalize: Normalize features before fitting</span>
<span class="sd">            max_iter: Maximum iterations for solver</span>
<span class="sd">            columns: Which columns to consider</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_lasso(outcome=&#39;target&#39;, alpha=0.1)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_lasso(outcome=&#39;target&#39;, top_n=10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.practical_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectLasso</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectLasso</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">normalize</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span>
            <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_ridge">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_ridge">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_ridge</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features using Ridge (L2 regularization) regression.</span>

<span class="sd">        Ridge provides stable coefficient estimates. Features ranked by</span>
<span class="sd">        absolute coefficient values.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            alpha: Regularization strength (default 1.0)</span>
<span class="sd">            threshold: Keep features with |coefficient| &gt;= threshold</span>
<span class="sd">            top_n: Keep top N features by |coefficient|</span>
<span class="sd">            normalize: Normalize features before fitting</span>
<span class="sd">            columns: Which columns to consider</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_ridge(outcome=&#39;target&#39;, alpha=0.5)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_ridge(outcome=&#39;target&#39;, top_n=15)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.practical_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectRidge</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectRidge</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">normalize</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_elastic_net">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_elastic_net">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_elastic_net</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">l1_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features using Elastic Net (L1 + L2 regularization).</span>

<span class="sd">        Combines Lasso and Ridge benefits - can zero out coefficients</span>
<span class="sd">        while maintaining stability.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            alpha: Overall regularization strength (default 1.0)</span>
<span class="sd">            l1_ratio: L1 vs L2 balance - 1.0=Lasso, 0.0=Ridge (default 0.5)</span>
<span class="sd">            threshold: Keep features with |coefficient| &gt;= threshold</span>
<span class="sd">            top_n: Keep top N features by |coefficient|</span>
<span class="sd">            normalize: Normalize features before fitting</span>
<span class="sd">            max_iter: Maximum iterations for solver</span>
<span class="sd">            columns: Which columns to consider</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_elastic_net(outcome=&#39;target&#39;, l1_ratio=0.7)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_elastic_net(outcome=&#39;target&#39;, top_n=10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.practical_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectElasticNet</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectElasticNet</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">l1_ratio</span><span class="o">=</span><span class="n">l1_ratio</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">normalize</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span>
            <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_univariate">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_univariate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_univariate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">score_func</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;f_regression&#39;</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top_p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features using univariate statistical tests.</span>

<span class="sd">        Tests each feature independently using f_classif, f_regression,</span>
<span class="sd">        chi2, or mutual information.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            score_func: Scoring function (&#39;f_regression&#39;, &#39;f_classif&#39;, &#39;chi2&#39;,</span>
<span class="sd">                       &#39;mutual_info_regression&#39;, &#39;mutual_info_classif&#39;)</span>
<span class="sd">            threshold: Keep features with score &gt;= threshold</span>
<span class="sd">            top_n: Keep top N features by score</span>
<span class="sd">            top_p: Keep top proportion of features (0-1)</span>
<span class="sd">            columns: Which columns to consider</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_univariate(outcome=&#39;target&#39;, top_n=10)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_univariate(</span>
<span class="sd">            ...     outcome=&#39;class&#39;, score_func=&#39;f_classif&#39;, top_p=0.5</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.practical_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectUnivariate</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectUnivariate</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">score_func</span><span class="o">=</span><span class="n">score_func</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span>
            <span class="n">top_p</span><span class="o">=</span><span class="n">top_p</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_variance_threshold">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_variance_threshold">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_variance_threshold</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove low-variance features.</span>

<span class="sd">        Features with variance below threshold are removed. Useful for</span>
<span class="sd">        removing near-constant features.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshold: Variance threshold (default 0.0 = remove only constants)</span>
<span class="sd">            columns: Which columns to check</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_variance_threshold(threshold=0.01)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_variance_threshold()  # Remove constants</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.practical_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectVarianceThreshold</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectVarianceThreshold</span><span class="p">(</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_stationary">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_stationary">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_stationary</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="n">max_lag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select stationary time series features using ADF test.</span>

<span class="sd">        Tests each feature for stationarity using Augmented Dickey-Fuller test.</span>
<span class="sd">        Only stationary features (p-value &lt; alpha) are kept.</span>

<span class="sd">        Args:</span>
<span class="sd">            alpha: Significance level for ADF test (default 0.05)</span>
<span class="sd">            max_lag: Maximum lag for ADF test (default None = auto)</span>
<span class="sd">            columns: Which columns to test</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_stationary(alpha=0.05)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_stationary(alpha=0.01, max_lag=12)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.practical_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectStationary</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectStationary</span><span class="p">(</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">max_lag</span><span class="o">=</span><span class="n">max_lag</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_cointegration">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_cointegration">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_cointegration</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="n">max_lag</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features cointegrated with outcome (time series).</span>

<span class="sd">        Tests for cointegration between each feature and outcome using</span>
<span class="sd">        Engle-Granger test. Features with p-value &lt; alpha are kept.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome: Name of outcome variable</span>
<span class="sd">            alpha: Significance level (default 0.05)</span>
<span class="sd">            max_lag: Maximum lag for cointegration test (default None = auto)</span>
<span class="sd">            columns: Which columns to test</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_cointegration(outcome=&#39;target&#39;, alpha=0.05)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_cointegration(</span>
<span class="sd">            ...     outcome=&#39;target&#39;, alpha=0.01, max_lag=12</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.practical_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectCointegration</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectCointegration</span><span class="p">(</span>
            <span class="n">outcome</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">max_lag</span><span class="o">=</span><span class="n">max_lag</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_select_seasonal">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_select_seasonal">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_select_seasonal</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">period</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select features with significant seasonal patterns.</span>

<span class="sd">        Tests for seasonality using FFT to detect periodic patterns.</span>
<span class="sd">        Features with strong seasonality are kept.</span>

<span class="sd">        Args:</span>
<span class="sd">            period: Expected seasonal period (e.g., 12 for monthly, 7 for daily)</span>
<span class="sd">                   If None, automatically detects dominant period</span>
<span class="sd">            threshold: Minimum spectral power ratio (default 0.1)</span>
<span class="sd">            columns: Which columns to test</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_seasonal(period=12, threshold=0.1)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_select_seasonal()  # Auto-detect period</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.practical_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepSelectSeasonal</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepSelectSeasonal</span><span class="p">(</span>
            <span class="n">period</span><span class="o">=</span><span class="n">period</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="nb">id</span>
        <span class="p">))</span></div>


    <span class="c1"># ============================================================</span>
    <span class="c1"># Financial ML Steps (Advances in Financial Machine Learning)</span>
    <span class="c1"># ============================================================</span>

<div class="viewcode-block" id="Recipe.step_fractional_diff">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_fractional_diff">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_fractional_diff</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">d</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="n">auto_d</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">d_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stationarity_test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;adf&#39;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">date_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">group_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;frac_diff_&quot;</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply fractional differentiation to achieve stationarity while preserving memory.</span>

<span class="sd">        Uses Fixed-Width Window Fractional Differentiation (FFD) method to transform</span>
<span class="sd">        time series to be stationary while preserving long-term memory.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to differentiate (None = all numeric)</span>
<span class="sd">            d: Fractional differentiation order (0-1, default: 0.5). If None and auto_d=True, auto-calculates optimal d.</span>
<span class="sd">            auto_d: If True, automatically finds optimal d using stationarity tests (default: False)</span>
<span class="sd">            d_range: Range of d values to test when auto_d=True (default: [0.1, 0.2, ..., 0.9])</span>
<span class="sd">            stationarity_test: Test to use for stationarity (&#39;adf&#39; or &#39;kpss&#39;, default: &#39;adf&#39;)</span>
<span class="sd">            alpha: Significance level for stationarity test (default: 0.05)</span>
<span class="sd">            threshold: Threshold for determining optimal window (default: 1e-5)</span>
<span class="sd">            window: Window size for FFD (None = auto-determined)</span>
<span class="sd">            date_col: Optional date/time column for ordering</span>
<span class="sd">            group_col: Optional grouping column for panel data</span>
<span class="sd">            prefix: Prefix for created columns (default: &#39;frac_diff_&#39;)</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Manual d value</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_fractional_diff([&#39;price&#39;], d=0.5, date_col=&#39;date&#39;)</span>
<span class="sd">            &gt;&gt;&gt; </span>
<span class="sd">            &gt;&gt;&gt; # Auto-calculate optimal d</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_fractional_diff([&#39;price&#39;], auto_d=True, date_col=&#39;date&#39;)</span>
<span class="sd">            &gt;&gt;&gt; </span>
<span class="sd">            &gt;&gt;&gt; # Custom d range for testing</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_fractional_diff([&#39;price&#39;], auto_d=True, d_range=[0.3, 0.4, 0.5, 0.6], date_col=&#39;date&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.financial_ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepFractionalDiff</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepFractionalDiff</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span>
            <span class="n">auto_d</span><span class="o">=</span><span class="n">auto_d</span><span class="p">,</span>
            <span class="n">d_range</span><span class="o">=</span><span class="n">d_range</span><span class="p">,</span>
            <span class="n">stationarity_test</span><span class="o">=</span><span class="n">stationarity_test</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">date_col</span><span class="o">=</span><span class="n">date_col</span><span class="p">,</span>
            <span class="n">group_col</span><span class="o">=</span><span class="n">group_col</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_volatility_ewm">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_volatility_ewm">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_volatility_ewm</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">return_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">span</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
        <span class="n">use_returns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">date_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">group_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;vol_ewm_&quot;</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate exponentially weighted moving volatility.</span>

<span class="sd">        Computes volatility using exponentially weighted moving average of squared returns,</span>
<span class="sd">        giving more weight to recent observations.</span>

<span class="sd">        Args:</span>
<span class="sd">            return_col: Column containing returns (or prices if use_returns=False)</span>
<span class="sd">            span: Span for exponential weighting (default: 20)</span>
<span class="sd">            use_returns: Whether input column is returns (True) or prices (False)</span>
<span class="sd">            date_col: Optional date/time column for ordering</span>
<span class="sd">            group_col: Optional grouping column for panel data</span>
<span class="sd">            prefix: Prefix for created columns (default: &#39;vol_ewm_&#39;)</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_volatility_ewm(&#39;returns&#39;, span=20, date_col=&#39;date&#39;)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_volatility_ewm(&#39;price&#39;, use_returns=False, span=30)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.financial_ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepVolatilityEWM</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepVolatilityEWM</span><span class="p">(</span>
            <span class="n">return_col</span><span class="o">=</span><span class="n">return_col</span><span class="p">,</span>
            <span class="n">span</span><span class="o">=</span><span class="n">span</span><span class="p">,</span>
            <span class="n">use_returns</span><span class="o">=</span><span class="n">use_returns</span><span class="p">,</span>
            <span class="n">date_col</span><span class="o">=</span><span class="n">date_col</span><span class="p">,</span>
            <span class="n">group_col</span><span class="o">=</span><span class="n">group_col</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_permutation_entropy">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_permutation_entropy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_permutation_entropy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">date_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">group_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;perm_entropy_&quot;</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate permutation entropy for time series.</span>

<span class="sd">        Measures complexity and predictability of time series by analyzing ordinal patterns.</span>
<span class="sd">        More robust to noise than Shannon entropy.</span>

<span class="sd">        Args:</span>
<span class="sd">            columns: Columns to calculate entropy for (None = all numeric)</span>
<span class="sd">            window: Rolling window (None = full series)</span>
<span class="sd">            order: Order of permutations (default: 3)</span>
<span class="sd">            normalize: Whether to normalize entropy (default: True)</span>
<span class="sd">            date_col: Optional date/time column for ordering</span>
<span class="sd">            group_col: Optional grouping column for panel data</span>
<span class="sd">            prefix: Prefix for created columns (default: &#39;perm_entropy_&#39;)</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_permutation_entropy([&#39;returns&#39;], window=60, order=3)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_permutation_entropy(order=4, normalize=False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.financial_ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepPermutationEntropy</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepPermutationEntropy</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
            <span class="n">normalize</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span>
            <span class="n">date_col</span><span class="o">=</span><span class="n">date_col</span><span class="p">,</span>
            <span class="n">group_col</span><span class="o">=</span><span class="n">group_col</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.step_weight_time_decay">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.step_weight_time_decay">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">step_weight_time_decay</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">date_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">decay_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="s2">&quot;exponential&quot;</span><span class="p">,</span> <span class="s2">&quot;piecewise&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;exponential&quot;</span><span class="p">,</span>
        <span class="n">base_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">weight_col_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
        <span class="n">group_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Recipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply time decay weighting to observations.</span>

<span class="sd">        Assigns higher weights to more recent observations, reflecting the adaptive</span>
<span class="sd">        nature of financial markets.</span>

<span class="sd">        Args:</span>
<span class="sd">            date_col: Date/time column for determining observation age</span>
<span class="sd">            decay_rate: Decay rate (higher = faster decay, default: 0.1)</span>
<span class="sd">            method: Decay method - &#39;linear&#39;, &#39;exponential&#39;, or &#39;piecewise&#39; (default: &#39;exponential&#39;)</span>
<span class="sd">            base_weight: Base weight for oldest observations (default: 1.0)</span>
<span class="sd">            weight_col_name: Name for the weight column (default: &#39;weight&#39;)</span>
<span class="sd">            group_col: Optional grouping column for panel data</span>
<span class="sd">            skip: Skip this step</span>
<span class="sd">            id: Unique identifier</span>

<span class="sd">        Returns:</span>
<span class="sd">            Recipe with step added</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_weight_time_decay(&#39;date&#39;, decay_rate=0.1, method=&#39;exponential&#39;)</span>
<span class="sd">            &gt;&gt;&gt; rec = recipe().step_weight_time_decay(&#39;date&#39;, decay_rate=0.2, method=&#39;linear&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">py_recipes.steps.financial_ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">StepWeightTimeDecay</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">StepWeightTimeDecay</span><span class="p">(</span>
            <span class="n">date_col</span><span class="o">=</span><span class="n">date_col</span><span class="p">,</span>
            <span class="n">decay_rate</span><span class="o">=</span><span class="n">decay_rate</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">base_weight</span><span class="o">=</span><span class="n">base_weight</span><span class="p">,</span>
            <span class="n">weight_col_name</span><span class="o">=</span><span class="n">weight_col_name</span><span class="p">,</span>
            <span class="n">group_col</span><span class="o">=</span><span class="n">group_col</span>
        <span class="p">))</span></div>


<div class="viewcode-block" id="Recipe.prep">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.Recipe.prep">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">prep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PreparedRecipe&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit recipe to training data.</span>

<span class="sd">        Executes each step&#39;s prep() method sequentially, fitting parameters</span>
<span class="sd">        on the training data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: Training data</span>
<span class="sd">            training: Whether this is training data</span>

<span class="sd">        Returns:</span>
<span class="sd">            PreparedRecipe ready to bake new data</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; rec = Recipe().step_normalize()</span>
<span class="sd">            &gt;&gt;&gt; rec_fit = rec.prep(train_data)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prepared_steps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
            <span class="c1"># Prep the step</span>
            <span class="n">prepared_step</span> <span class="o">=</span> <span class="n">step</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="n">current_data</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="n">training</span><span class="p">)</span>
            <span class="n">prepared_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prepared_step</span><span class="p">)</span>

            <span class="c1"># Apply step to current data for next step</span>
            <span class="n">current_data</span> <span class="o">=</span> <span class="n">prepared_step</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">current_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">PreparedRecipe</span><span class="p">(</span>
            <span class="n">recipe</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">prepared_steps</span><span class="o">=</span><span class="n">prepared_steps</span><span class="p">,</span>
            <span class="n">template</span><span class="o">=</span><span class="n">data</span>
        <span class="p">)</span></div>
</div>



<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PreparedRecipe</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fitted recipe ready to transform new data.</span>

<span class="sd">    Created by Recipe.prep(), contains fitted preprocessing steps</span>
<span class="sd">    that can be applied to new data via bake().</span>

<span class="sd">    Attributes:</span>
<span class="sd">        recipe: Original Recipe specification</span>
<span class="sd">        prepared_steps: List of fitted PreparedStep objects</span>
<span class="sd">        template: Template DataFrame from training</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; rec_fit = recipe.prep(train_data)</span>
<span class="sd">        &gt;&gt;&gt; test_transformed = rec_fit.bake(test_data)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">recipe</span><span class="p">:</span> <span class="n">Recipe</span>
    <span class="n">prepared_steps</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
    <span class="n">template</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bake</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply fitted recipe to new data.</span>

<span class="sd">        Applies each prepared step sequentially to transform the data</span>
<span class="sd">        using parameters fitted during prep().</span>

<span class="sd">        Args:</span>
<span class="sd">            new_data: Data to transform</span>

<span class="sd">        Returns:</span>
<span class="sd">            Transformed DataFrame</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; test_transformed = rec_fit.bake(test_data)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">prepared_step</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepared_steps</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">prepared_step</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">juice</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract transformed training data.</span>

<span class="sd">        Returns the training data after all transformations have been applied.</span>
<span class="sd">        Equivalent to bake(template).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Transformed training DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>


<div class="viewcode-block" id="recipe">
<a class="viewcode-back" href="../../api/recipes.html#py_recipes.recipe">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">recipe</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Recipe</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new recipe.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Optional template DataFrame for role inference</span>

<span class="sd">    Returns:</span>
<span class="sd">        Empty Recipe ready for steps</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; rec = recipe().step_normalize().step_dummy([&quot;category&quot;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Recipe</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="n">data</span><span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Matthew Deane.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>